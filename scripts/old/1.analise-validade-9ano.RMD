---
title: "Dados EIB - 9º ano - Evidências de validade para estudantes com 14 anos no 9º ano escolar"
author: "eduLab21®️ (Ana C e Gustavo)"
date: "Relatório produzido em: `r format(Sys.time(), '%d %B, %Y')`"
output:
  html_document:
    css: style.css
    theme: united
    includes:
      in_header: logo.html
    toc: true
    toc_float:
      collapsed: false
      smooth_scroll: true
    toc_depth: 3
    number_sections: false
    code_folding: hide
    code_download: true
link-citations: true
---

```{r setup, warning=FALSE, message=FALSE, include=FALSE}
knitr::opts_chunk$set(warning=FALSE, message=FALSE)
```

```{r pacotes_db}
# Pacotes -----------------------------------------------------------------
library(tidyverse)
library(careless)
library(summarytools)
library(htmltools)
library(psych)
library(readxl)
library(lavaan)
library(reactable)
library(sjmisc)
library(semTools)
```

```{r eval=TRUE, echo=FALSE, include=FALSE}
# Importar banco (Alterar para Knit > Knit directory > Project directory)
# Eu mudei no próprio excel os coditem para ficar padronizado entre os bancos
dt_MT_2022 <- readxl::read_xlsx("data/dt_hol_clean_14_coditem.xlsx")

# Carregar dicionario
dic_eib <- read_xlsx("dic/dic_eib.xlsx")

# Carregar banco 2019 - Rod e Leo
dt_SP_2019 <- readRDS("data/dt_hol_EIB.RDS")
# Manter somente a amostra de adolescentes contidas no manual da EIB n = 670
dt_SP_2019 <- dt_SP_2019 %>% 
  filter(Grupo == 2)
```

```{r}
# Vetores com o dic_itens por tipo do RIASEC
v_realista <- dic_eib %>% 
  filter(domain == "R")

v_investigativo <- dic_eib %>% 
  filter(domain == "I")

v_artistico <- dic_eib %>% 
  filter(domain == "A")

v_social <- dic_eib %>% 
  filter(domain == "S")

v_empreendedor <- dic_eib %>% 
  filter(domain == "E")

v_convencional <- dic_eib %>% 
  filter(domain == "C")
```



# Premissas para leitura do documento
- O objetivo das análises é identificar as evidências de validade e de precisão para aplicação do instrumento EIB em adolescentes de 14 anos que estão cursando o 9º ano escolar.

- Os itens 26 (Participar de perseguições em alta velocidade) e 92 (92- Usar uma arma de fogo (revólver)) foram retirados de acordo com decisão em 13/02/2023.

# Sumário
1 - Distribuição das respostas por itens

2 - Exploração da estrutura interna com EFA (estimador WLSMV e rotação oblimin)

3 - Exploração da estrutura interna com CFA (estimador WLSMV e rotação oblimin)

4 - Precisão Alfa e Ômega

5 - Diferenças entre bancos e sexo

6 - Nova tabela de normas


# Distribuição das respostas por itens{.tabset .tabset-fade}
## Dicionário de itens
```{r eval=FALSE, include=FALSE}
# Ver dic itens
reactable::reactable(dic_eib, filterable = TRUE)
```

## Descritivas
```{r}
# descritivas de respostas por itens
dt_MT_2022 %>% 
  dplyr::select(starts_with("eib")) %>% 
  summary()
```

## Frequências
```{r}
# frequências de respostas por itens
dt_MT_2022 %>% 
  dplyr::select(starts_with("eib")) %>% 
  freq()
```


# AFE {.tabset .tabset-fade}
## Realista
```{r eval=TRUE, echo=FALSE}
# rodar AFE
efa_hol_R <- lavaan::efa(
  dt_MT_2022, 
  nfactors = 5, 
  rotation = "oblimin", 
  ov.names= c(
    "EIB1",
    "EIB23",
    "EIB45",
    "EIB67_12",
    "EIB89_34",
    "EIB2",
    "EIB24",
    "EIB46",
    "EIB68_13",
    "EIB90_35",
    "EIB3",
    "EIB25",
    "EIB47",
    "EIB69_14",
    "EIB91_36",
    "EIB4",
    #"EIB26",
    "EIB48",
    "EIB70_15",
    #"EIB92_37",
    "EIB5",
    "EIB27",
    "EIB49",
    "EIB71_16",
    "EIB93_38"
  ), 
  ordered=TRUE
)

# ver resultados
summary(efa_hol_R, standardized = TRUE, fit.measures = TRUE, cutoff = 0.001)
fitMeasures(efa_hol_R)
```

## Investigativo
```{r eval=TRUE, echo=FALSE}
# rodar AFE
efa_hol_I <- lavaan::efa(
  dt_MT_2022, 
  nfactors = 2, 
  rotation = "oblimin", 
  ov.names= c(
    "EIB6",
    "EIB28",
    "EIB50",
    "EIB72_17",
    "EIB94_39",
    "EIB7",
    "EIB29",
    "EIB51",
    "EIB73_18",
    "EIB95_40"
  ), 
  ordered=TRUE
)

# ver resultados
summary(efa_hol_I, standardized = TRUE, fit.measures = TRUE, cutoff = 0.001)
fitMeasures(efa_hol_I)
```

## Artístico
```{r eval=TRUE, echo=FALSE}
# rodar AFE
efa_hol_A <- lavaan::efa(
  dt_MT_2022, 
  nfactors = 3, 
  rotation = "oblimin", 
  ov.names= c(
    "EIB8",
    "EIB30",
    "EIB52",
    "EIB74_19",
    "EIB96_41",
    "EIB9",
    "EIB31",
    "EIB53",
    "EIB75_20",
    "EIB97_42",
    "EIB10",
    "EIB32",
    "EIB54",
    "EIB76_21",
    "EIB98_43"
  ), 
  ordered=TRUE
)

# ver resultados
summary(efa_hol_A, standardized = TRUE, fit.measures = TRUE, cutoff = 0.001)
fitMeasures(efa_hol_A)
```

## Social
```{r eval=TRUE, echo=FALSE}
# rodar AFE
efa_hol_S <- lavaan::efa(
  dt_MT_2022, 
  nfactors = 6, 
  rotation = "oblimin", 
  ov.names= c(
    "EIB11",
    "EIB33",
    "EIB55",
    "EIB77_22",
    "EIB99_44",
    "EIB12",
    "EIB34",
    "EIB56_1",
    "EIB78_23",
    "EIB100_45",
    "EIB13",
    "EIB35",
    "EIB57_2",
    "EIB79_24",
    "EIB101_46",
    "EIB14",
    "EIB36",
    "EIB58_3",
    "EIB80_25",
    "EIB102_47",
    "EIB15",
    "EIB37",
    "EIB59_4",
    "EIB81_26",
    "EIB103_48",
    "EIB16",
    "EIB38",
    "EIB60_5",
    "EIB82_27",
    "EIB104_49"
  ), 
  ordered=TRUE
)

# ver resultados
summary(efa_hol_S, standardized = TRUE, fit.measures = TRUE, cutoff = 0.001)
fitMeasures(efa_hol_S)
```

## Empreendedor
```{r eval=TRUE, echo=FALSE}
# rodar AFE
efa_hol_E <- lavaan::efa(
  dt_MT_2022, 
  nfactors = 4, 
  rotation = "oblimin", 
  ov.names= c(
    "EIB17",
    "EIB39",
    "EIB61_6",
    "EIB83_28",
    "EIB105_50",
    "EIB18",
    "EIB40",
    "EIB62_7",
    "EIB84_29",
    "EIB106_51",
    "EIB19",
    "EIB41",
    "EIB63_8",
    "EIB85_30",
    "EIB107_52",
    "EIB20",
    "EIB42",
    "EIB64_9",
    "EIB86_31",
    "EIB108_53"
  ), 
  ordered=TRUE
)

# ver resultados
summary(efa_hol_E, standardized = TRUE, fit.measures = TRUE, cutoff = 0.001)
fitMeasures(efa_hol_E)
```

## Convencional
```{r eval=TRUE, echo=FALSE}
# rodar AFE
efa_hol_C <- lavaan::efa(
  dt_MT_2022, 
  nfactors = 2, 
  rotation = "oblimin", 
  ov.names= c(
    "EIB21",
    "EIB43",
    "EIB65_10",
    "EIB87_32",
    "EIB109_54",
    "EIB22",
    "EIB44",
    "EIB66_11",
    "EIB88_33",
    "EIB110_55"
  ), 
  ordered=TRUE
)

# ver resultados
summary(efa_hol_C, standardized = TRUE, fit.measures = TRUE, cutoff = 0.001)
fitMeasures(efa_hol_C)
```



# AFC {.tabset .tabset-fade}
## Realista
```{r eval=TRUE, echo=FALSE}
# modelo
modelo_R <- '
manual =~ NA*EIB1 + EIB23 + EIB45 + EIB67_12 + EIB89_34
manual ~~ 1*manual
natureza =~ NA*EIB2 + EIB24 + EIB46 + EIB68_13 + EIB90_35
natureza ~~ 1*natureza
tecnologia =~ NA*EIB3 + EIB25 + EIB47 + EIB69_14 + EIB91_36
tecnologia ~~ 1*tecnologia
seguranca =~ NA*EIB4 + EIB48 + EIB70_15
seguranca ~~ 1*seguranca
esporte =~ NA*EIB5 + EIB27 +  EIB49 + EIB71_16 + EIB93_38
esporte ~~ 1*esporte
'

# rodar AFC
cfa_hol_R <- sem(
  dt_MT_2022,
  model = modelo_R,
  rotation = "oblimin", 
  ordered=TRUE
)

# ver resultados
summary(cfa_hol_R, standardized = TRUE, fit.measures = TRUE)
```

## Investigativo
```{r eval=TRUE, echo=FALSE}
# modelo
modelo_I <- '
cie_naturais =~ NA*EIB6 + EIB28 + EIB50 + EIB72_17 + EIB94_39
cie_naturais ~~ 1*cie_naturais
cie_humanas =~ NA*EIB7 + EIB29 + EIB51 + EIB73_18 + EIB95_40
cie_humanas ~~ 1*cie_humanas
'

# rodar AFC
cfa_hol_I <- sem(
  dt_MT_2022,
  model = modelo_I,
  rotation = "oblimin", 
  ordered=TRUE
)

# ver resultados
summary(cfa_hol_I, standardized = TRUE, fit.measures = TRUE)
```

## Artístico
```{r eval=TRUE, echo=FALSE}
# modelo
modelo_A <- '
criacao =~ NA*EIB8 + EIB30 + EIB52 + EIB74_19 + EIB96_41
criacao ~~ 1*criacao
performance =~ NA*EIB9 + EIB31 + EIB53 + EIB75_20 + EIB97_42
performance ~~ 1*performance
exibicao =~ NA*EIB10 + EIB32 + EIB54 + EIB76_21 + EIB98_43
exibicao ~~ 1*exibicao
'

# rodar AFC
cfa_hol_A <- sem(
  dt_MT_2022,
  model = modelo_A,
  rotation = "oblimin", 
  ordered=TRUE
)

# ver resultados
summary(cfa_hol_A, standardized = TRUE, fit.measures = TRUE)
```

## Social
```{r eval=TRUE, echo=FALSE}
# modelo
modelo_S <- '
aconselhamento =~ NA*EIB11 + EIB33 + EIB55 + EIB77_22 + EIB99_44
aconselhamento ~~ 1*aconselhamento
educacao =~ NA*EIB12 + EIB34 + EIB56_1 + EIB78_23 + EIB100_45
educacao ~~ 1*educacao
saude =~ NA*EIB13 + EIB35 + EIB57_2 + EIB79_24 + EIB101_46
saude ~~ 1*saude
familia =~ NA*EIB14 + EIB36 + EIB58_3 + EIB80_25 + EIB102_47
familia ~~ 1*familia
altruismo =~ NA*EIB15 + EIB37 + EIB59_4 + EIB81_26 + EIB103_48
altruismo ~~ 1*altruismo
religiosidade =~ NA*EIB16 + EIB38 + EIB60_5 + EIB82_27 + EIB104_49
religiosidade ~~ 1*religiosidade
'

# rodar AFC
cfa_hol_S <- sem(
  dt_MT_2022,
  model = modelo_S,
  rotation = "oblimin", 
  ordered=TRUE
)

# ver resultados
summary(cfa_hol_S, standardized = TRUE, fit.measures = TRUE)
```

## Empreendedor
```{r eval=TRUE, echo=FALSE}
# modelo
modelo_E <- '
lideranca =~ NA*EIB17 + EIB39 + EIB61_6 + EIB83_28 + EIB105_50
lideranca ~~ 1*lideranca
organizacional =~ NA*EIB18 + EIB40 + EIB62_7 + EIB84_29 + EIB106_51
organizacional ~~ 1*organizacional
politica =~ NA*EIB19 + EIB41 + EIB63_8 + EIB85_30 + EIB107_52
politica ~~ 1*politica
vendas =~ NA*EIB20 + EIB42 + EIB64_9 + EIB86_31 + EIB108_53
vendas ~~ 1*vendas
'

# rodar AFC
cfa_hol_E <- sem(
  dt_MT_2022,
  model = modelo_E,
  rotation = "oblimin", 
  ordered=TRUE
)

# ver resultados
summary(cfa_hol_E, standardized = TRUE, fit.measures = TRUE)
```

## Convencional
```{r eval=TRUE, echo=FALSE}
# modelo
modelo_C <- '
rotinas =~ NA*EIB21 + EIB43 + EIB65_10 + EIB87_32 + EIB109_54
rotinas ~~ 1*rotinas
financas =~ NA*EIB22 + EIB44 + EIB66_11 + EIB88_33 + EIB110_55
financas ~~ 1*financas
'

# rodar AFC
cfa_hol_C <- sem(
  dt_MT_2022,
  model = modelo_C,
  rotation = "oblimin", 
  ordered=TRUE
)

# ver resultados
summary(cfa_hol_C, standardized = TRUE, fit.measures = TRUE)
```


# Precisão {.tabset .tabset-fade}
## Manual
```{r}
# Rodar consistência interna
jmv::reliability(
  data = dt_MT_2022,
  vars = vars(
    EIB1,
EIB23,
EIB45,
EIB67_12,
EIB89_34
  ),
  omegaScale = TRUE,
  alphaItems = TRUE,
  omegaItems = TRUE,
  corPlot = TRUE
)
```

## Natureza
```{r}
# Rodar consistência interna
jmv::reliability(
  data = dt_MT_2022,
  vars = vars(
    EIB2,
EIB24,
EIB46,
EIB68_13,
EIB90_35
  ),
  omegaScale = TRUE,
  alphaItems = TRUE,
  omegaItems = TRUE,
  corPlot = TRUE
)
```

## Tecnologia
```{r}
# Rodar consistência interna
jmv::reliability(
  data = dt_MT_2022,
  vars = vars(
    EIB3,
EIB25,
EIB47,
EIB69_14,
EIB91_36
  ),
  omegaScale = TRUE,
  alphaItems = TRUE,
  omegaItems = TRUE,
  corPlot = TRUE
)
```

## Segurança
```{r}
# Rodar consistência interna
jmv::reliability(
  data = dt_MT_2022,
  vars = vars(
    EIB4,
    EIB48,
    EIB70_15
  ),
  omegaScale = TRUE,
  alphaItems = TRUE,
  omegaItems = TRUE,
  corPlot = TRUE
)
```

## Esporte
```{r}
# Rodar consistência interna
jmv::reliability(
  data = dt_MT_2022,
  vars = vars(
    EIB5,
EIB27,
EIB49,
EIB71_16,
EIB93_38
  ),
  omegaScale = TRUE,
  alphaItems = TRUE,
  omegaItems = TRUE,
  corPlot = TRUE
)
```

## Realista
```{r}
# Rodar consistência interna
jmv::reliability(
  data = dt_MT_2022,
  vars = vars(
    EIB5,
EIB27,
EIB49,
EIB71_16,
EIB93_38,
EIB1,
EIB23,
EIB45,
EIB67_12,
EIB89_34,
EIB2,
EIB24,
EIB46,
EIB68_13,
EIB90_35,
EIB4,
EIB26,
EIB48,
EIB70_15,
EIB92_37,
EIB3,
EIB25,
EIB47,
EIB69_14,
EIB91_36
  ),
  omegaScale = TRUE,
  alphaItems = TRUE,
  omegaItems = TRUE,
  corPlot = TRUE
)
```

## cie_humanas
```{r}
# Rodar consistência interna
jmv::reliability(
  data = dt_MT_2022,
  vars = vars(
    EIB7,
EIB29,
EIB51,
EIB73_18,
EIB95_40
  ),
  omegaScale = TRUE,
  alphaItems = TRUE,
  omegaItems = TRUE,
  corPlot = TRUE
)
```

## cie_naturais
```{r}
# Rodar consistência interna
jmv::reliability(
  data = dt_MT_2022,
  vars = vars(
    EIB6,
EIB28,
EIB50,
EIB72_17,
EIB94_39
  ),
  omegaScale = TRUE,
  alphaItems = TRUE,
  omegaItems = TRUE,
  corPlot = TRUE
)
```

## Investigativo
```{r}
# Rodar consistência interna
jmv::reliability(
  data = dt_MT_2022,
  vars = vars(
    EIB7,
EIB29,
EIB51,
EIB73_18,
EIB95_40,
EIB6,
EIB28,
EIB50,
EIB72_17,
EIB94_39
  ),
  omegaScale = TRUE,
  alphaItems = TRUE,
  omegaItems = TRUE,
  corPlot = TRUE
)
```

## criacao
```{r}
# Rodar consistência interna
jmv::reliability(
  data = dt_MT_2022,
  vars = vars(
    EIB8,
EIB30,
EIB52,
EIB74_19,
EIB96_41
  ),
  omegaScale = TRUE,
  alphaItems = TRUE,
  omegaItems = TRUE,
  corPlot = TRUE
)
```

## exibicao
```{r}
# Rodar consistência interna
jmv::reliability(
  data = dt_MT_2022,
  vars = vars(
    EIB10,
EIB32,
EIB54,
EIB76_21,
EIB98_43
  ),
  omegaScale = TRUE,
  alphaItems = TRUE,
  omegaItems = TRUE,
  corPlot = TRUE
)
```

## performance
```{r}
# Rodar consistência interna
jmv::reliability(
  data = dt_MT_2022,
  vars = vars(
    EIB9,
EIB31,
EIB53,
EIB75_20,
EIB97_42
  ),
  omegaScale = TRUE,
  alphaItems = TRUE,
  omegaItems = TRUE,
  corPlot = TRUE
)
```

## Artístico
```{r}
# Rodar consistência interna
jmv::reliability(
  data = dt_MT_2022,
  vars = vars(
    EIB8,
EIB30,
EIB52,
EIB74_19,
EIB96_41,
EIB10,
EIB32,
EIB54,
EIB76_21,
EIB98_43,
EIB9,
EIB31,
EIB53,
EIB75_20,
EIB97_42
  ),
  omegaScale = TRUE,
  alphaItems = TRUE,
  omegaItems = TRUE,
  corPlot = TRUE
)
```

## aconselhamento
```{r}
# Rodar consistência interna
jmv::reliability(
  data = dt_MT_2022,
  vars = vars(
    EIB11,
EIB33,
EIB55,
EIB77_22,
EIB99_44

  ),
  omegaScale = TRUE,
  alphaItems = TRUE,
  omegaItems = TRUE,
  corPlot = TRUE
)
```

## educacao
```{r}
# Rodar consistência interna
jmv::reliability(
  data = dt_MT_2022,
  vars = vars(
    EIB12,
EIB34,
EIB56_1,
EIB78_23,
EIB100_45

  ),
  omegaScale = TRUE,
  alphaItems = TRUE,
  omegaItems = TRUE,
  corPlot = TRUE
)
```

## saude
```{r}
# Rodar consistência interna
jmv::reliability(
  data = dt_MT_2022,
  vars = vars(
    EIB13,
EIB35,
EIB57_2,
EIB79_24,
EIB101_46

  ),
  omegaScale = TRUE,
  alphaItems = TRUE,
  omegaItems = TRUE,
  corPlot = TRUE
)
```

## familia
```{r}
# Rodar consistência interna
jmv::reliability(
  data = dt_MT_2022,
  vars = vars(
    EIB14,
EIB36,
EIB58_3,
EIB80_25,
EIB102_47

  ),
  omegaScale = TRUE,
  alphaItems = TRUE,
  omegaItems = TRUE,
  corPlot = TRUE
)
```

## altruismo
```{r}
# Rodar consistência interna
jmv::reliability(
  data = dt_MT_2022,
  vars = vars(
    EIB15,
EIB37,
EIB59_4,
EIB81_26,
EIB103_48

  ),
  omegaScale = TRUE,
  alphaItems = TRUE,
  omegaItems = TRUE,
  corPlot = TRUE
)
```

## religiosidade
```{r}
# Rodar consistência interna
jmv::reliability(
  data = dt_MT_2022,
  vars = vars(
    EIB16,
EIB38,
EIB60_5,
EIB82_27,
EIB104_49

  ),
  omegaScale = TRUE,
  alphaItems = TRUE,
  omegaItems = TRUE,
  corPlot = TRUE
)
```

## Social
```{r}
# Rodar consistência interna
jmv::reliability(
  data = dt_MT_2022,
  vars = vars(
    EIB11,
EIB33,
EIB55,
EIB77_22,
EIB99_44,
EIB12,
EIB34,
EIB56_1,
EIB78_23,
EIB100_45,
EIB13,
EIB35,
EIB57_2,
EIB79_24,
EIB101_46,
EIB14,
EIB36,
EIB58_3,
EIB80_25,
EIB102_47,
EIB15,
EIB37,
EIB59_4,
EIB81_26,
EIB103_48,
EIB16,
EIB38,
EIB60_5,
EIB82_27,
EIB104_49
  ),
  omegaScale = TRUE,
  alphaItems = TRUE,
  omegaItems = TRUE,
  corPlot = TRUE
)
```

## lideranca
```{r}
# Rodar consistência interna
jmv::reliability(
  data = dt_MT_2022,
  vars = vars(
    EIB17,
EIB39,
EIB61_6,
EIB83_28,
EIB105_50


  ),
  omegaScale = TRUE,
  alphaItems = TRUE,
  omegaItems = TRUE,
  corPlot = TRUE
)
```

## organizacional
```{r}
# Rodar consistência interna
jmv::reliability(
  data = dt_MT_2022,
  vars = vars(
    EIB18,
EIB40,
EIB62_7,
EIB84_29,
EIB106_51
  ),
  omegaScale = TRUE,
  alphaItems = TRUE,
  omegaItems = TRUE,
  corPlot = TRUE
)
```

## politica
```{r}
# Rodar consistência interna
jmv::reliability(
  data = dt_MT_2022,
  vars = vars(
    EIB19,
EIB41,
EIB63_8,
EIB85_30,
EIB107_52


  ),
  omegaScale = TRUE,
  alphaItems = TRUE,
  omegaItems = TRUE,
  corPlot = TRUE
)
```

## vendas
```{r}
# Rodar consistência interna
jmv::reliability(
  data = dt_MT_2022,
  vars = vars(
    EIB20,
EIB42,
EIB64_9,
EIB86_31,
EIB108_53
  ),
  omegaScale = TRUE,
  alphaItems = TRUE,
  omegaItems = TRUE,
  corPlot = TRUE
)
```

## Empreendedor
```{r}
# Rodar consistência interna
jmv::reliability(
  data = dt_MT_2022,
  vars = vars(
    EIB17,
EIB39,
EIB61_6,
EIB83_28,
EIB105_50,
EIB18,
EIB40,
EIB62_7,
EIB84_29,
EIB106_51,
EIB19,
EIB41,
EIB63_8,
EIB85_30,
EIB107_52,
EIB20,
EIB42,
EIB64_9,
EIB86_31,
EIB108_53
  ),
  omegaScale = TRUE,
  alphaItems = TRUE,
  omegaItems = TRUE,
  corPlot = TRUE
)
```

## financas
```{r}
# Rodar consistência interna
jmv::reliability(
  data = dt_MT_2022,
  vars = vars(
    EIB22,
EIB44,
EIB66_11,
EIB88_33,
EIB110_55
  ),
  omegaScale = TRUE,
  alphaItems = TRUE,
  omegaItems = TRUE,
  corPlot = TRUE
)
```

## rotinas
```{r}
# Rodar consistência interna
jmv::reliability(
  data = dt_MT_2022,
  vars = vars(
    EIB21,
EIB43,
EIB65_10,
EIB87_32,
EIB109_54

  ),
  omegaScale = TRUE,
  alphaItems = TRUE,
  omegaItems = TRUE,
  corPlot = TRUE
)
```

## Convencional
```{r}
# Rodar consistência interna
jmv::reliability(
  data = dt_MT_2022,
  vars = vars(
    EIB22,
EIB44,
EIB66_11,
EIB88_33,
EIB110_55,
EIB21,
EIB43,
EIB65_10,
EIB87_32,
EIB109_54
  ),
  omegaScale = TRUE,
  alphaItems = TRUE,
  omegaItems = TRUE,
  corPlot = TRUE
)
```

# Derivação da tabela de normas para 14 anos{.tabset .tabset-fade}
```{r include=FALSE}
# Checar de nomes MT 2022
names(dt_MT_2022)

dt_MT_2022 %>%
  dplyr::select(starts_with("eib")) %>% 
  names()

# Checar de nomes SP 2019
names(dt_SP_2019)

dt_SP_2019 %>%
  dplyr::select(starts_with("eib")) %>% 
  names()
```

```{r}
# recodificar sexo para ficar igual SP_2019
dt_MT_2022_limpo <- dt_MT_2022 

dt_MT_2022_limpo$Sexo <- recode(dt_MT_2022_limpo$como_voce_se_identifica, Masculino = 1, Feminino = 2)

# juntar os bancos dos bancos
dt_MT_SP <- bind_rows(list(MT = dt_MT_2022_limpo, SP = dt_SP_2019), .id = "banco")
```

```{r include=FALSE}
# quais são as facetas
facetas <- unique (dic_eib$facet)

# quais são os itens de cada faceta?
# aqui é um loop que vai criar um objeto para cada fator
# o objeto contém os códigos dos itens do fator
for (i in facetas){
  eval(
    parse(
      text = paste0(
        i,
        ' <- dic_eib$coditem[dic_eib$facet == i]'
      )
    )
  )
}

# remover os itens 26 e 92
seguranca
seguranca <- seguranca[-c(2, 5)]


# quais são os tipos
tipos <- unique (dic_eib$domain)

# quais são os itens de cada faceta?
# aqui é um loop que vai criar um objeto para cada fator
# o objeto contém os códigos dos itens do fator
for (i in tipos){
  eval(
    parse(
      text = paste0(
        i,
        ' <- dic_eib$coditem[dic_eib$domain == i]'
      )
    )
  )
}

# remover os itens 26 e 92
R
R <- R[-c(9, 24)]
```
Precisamos decidir se vai computador os casos com NA. Se sim acrescentar "na.rm = TRUE" na hora de calcular os escores

```{r}
#### computar os escores dos fatores ####

#computar os escores da versão completa
dt_MT_SP$manual <- apply(
  dt_MT_SP[,manual],
  1,
  sum
)
dt_MT_SP$natureza <- apply(
  dt_MT_SP[,natureza],
  1,
  sum
)
dt_MT_SP$tecnologia <- apply(
  dt_MT_SP[,tecnologia],
  1,
  sum
)
dt_MT_SP$seguranca <- apply(
  dt_MT_SP[,seguranca],
  1,
  sum
)
dt_MT_SP$esportes <- apply(
  dt_MT_SP[,esportes],
  1,
  sum
)

dt_MT_SP$cie_naturais <- apply(
  dt_MT_SP[,cie_naturais],
  1,
  sum
)
dt_MT_SP$cie_humanas <- apply(
  dt_MT_SP[,cie_humanas],
  1,
  sum
)

dt_MT_SP$criacao <- apply(
  dt_MT_SP[,criacao],
  1,
  sum
)
dt_MT_SP$performance <- apply(
  dt_MT_SP[,performance],
  1,
  sum
)
dt_MT_SP$exibicao <- apply(
  dt_MT_SP[,exibicao],
  1,
  sum
)

dt_MT_SP$aconselhamento <- apply(
  dt_MT_SP[,aconselhamento],
  1,
  sum
)
dt_MT_SP$educacao <- apply(
  dt_MT_SP[,educacao],
  1,
  sum
)
dt_MT_SP$saude <- apply(
  dt_MT_SP[,saude],
  1,
  sum
)
dt_MT_SP$familia <- apply(
  dt_MT_SP[,familia],
  1,
  sum
)
dt_MT_SP$altruismo <- apply(
  dt_MT_SP[,altruismo],
  1,
  sum
)
dt_MT_SP$religiosidade <- apply(
  dt_MT_SP[,religiosidade],
  1,
  sum
)

dt_MT_SP$lideranca <- apply(
  dt_MT_SP[,lideranca],
  1,
  sum
)
dt_MT_SP$organizacional <- apply(
  dt_MT_SP[,organizacional],
  1,
  sum
)
dt_MT_SP$politica <- apply(
  dt_MT_SP[,politica],
  1,
  sum
)
dt_MT_SP$vendas <- apply(
  dt_MT_SP[,vendas],
  1,
  sum
)

dt_MT_SP$rotinas <- apply(
  dt_MT_SP[,rotinas],
  1,
  sum
)
dt_MT_SP$financas <- apply(
  dt_MT_SP[,financas],
  1,
  sum
)


dt_MT_SP$R <- apply(
  dt_MT_SP[,R],
  1,
  sum
)
dt_MT_SP$I <- apply(
  dt_MT_SP[,I],
  1,
  sum
)
dt_MT_SP$A <- apply(
  dt_MT_SP[,A],
  1,
  sum
)
dt_MT_SP$S <- apply(
  dt_MT_SP[,S],
  1,
  sum
)
dt_MT_SP$E <- apply(
  dt_MT_SP[,E],
  1,
  sum
)
dt_MT_SP$C <- apply(
  dt_MT_SP[,C],
  1,
  sum
)


# ########################## ARRUMAR ISSO considerando no mínimo (N itens - 1), exceto para proteção. Tipos considerar (n itens - n facetas)
# dt_MT_SP$manual <- dt_MT_SP %>% 
#   select(manual) %>% 
#   row_means(n = 4)
```

## diferença de média EM x 9º ano
```{r}
# analisar diferença de média
jmv::ttestIS(
    formula = manual + natureza + tecnologia + seguranca + esportes + cie_naturais + cie_humanas + criacao + performance + exibicao + aconselhamento + educacao + saude + familia + altruismo + religiosidade + lideranca + organizacional + politica + vendas + rotinas + financas + R + I + A + S + E + C ~ banco,
    data = dt_MT_SP,
    vars = vars(manual, natureza, tecnologia, seguranca, esportes, cie_naturais, cie_humanas, criacao, performance, exibicao, aconselhamento, educacao, saude, familia, altruismo, religiosidade, lideranca, organizacional, politica, vendas, rotinas, financas, R, I, A, S, E, C),
    welchs = TRUE,
    effectSize = TRUE,
    desc = TRUE)
```
## diferença de média masculino (1) x feminino (2)
```{r}
# analisar diferença de média
jmv::ttestIS(
    formula = manual + natureza + tecnologia + seguranca + esportes + cie_naturais + cie_humanas + criacao + performance + exibicao + aconselhamento + educacao + saude + familia + altruismo + religiosidade + lideranca + organizacional + politica + vendas + rotinas + financas + R + I + A + S + E + C ~ Sexo,
    data = dt_MT_SP,
    vars = vars(manual, natureza, tecnologia, seguranca, esportes, cie_naturais, cie_humanas, criacao, performance, exibicao, aconselhamento, educacao, saude, familia, altruismo, religiosidade, lideranca, organizacional, politica, vendas, rotinas, financas, R, I, A, S, E, C),
    welchs = TRUE,
    effectSize = TRUE,
    desc = TRUE)
```

# Normas amostra geral{.tabset .tabset-fade}
## R
```{r}
# Gerar amostra
jmv::descriptives(
    vars = vars (R, manual, natureza, tecnologia, seguranca, esportes),
    data = dt_MT_SP,
    mode = TRUE,
    variance = TRUE,
    pc = TRUE,
    pcValues = "10,20,30,40,50,60,70,80,90"
)
```

## I
```{r}
# Gerar amostra
jmv::descriptives(
    vars = vars(I, cie_naturais, cie_humanas),
    data = dt_MT_SP,
    mode = TRUE,
    variance = TRUE,
    pc = TRUE,
    pcValues = "10,20,30,40,50,60,70,80,90"
)
```

## A
```{r}
# Gerar amostra
jmv::descriptives(
    vars = vars(A, criacao, performance, exibicao),
    data = dt_MT_SP,
    mode = TRUE,
    variance = TRUE,
    pc = TRUE,
    pcValues = "10,20,30,40,50,60,70,80,90"
)
```

## S
```{r}
# Gerar amostra
jmv::descriptives(
    vars = vars (S, aconselhamento, educacao, saude, familia, altruismo, religiosidade),
    data = dt_MT_SP,
    mode = TRUE,
    variance = TRUE,
    pc = TRUE,
    pcValues = "10,20,30,40,50,60,70,80,90"
)
```

## E
```{r}
# Gerar amostra
jmv::descriptives(
    vars = vars (E, lideranca, organizacional, politica, vendas),
    data = dt_MT_SP,
    mode = TRUE,
    variance = TRUE,
    pc = TRUE,
    pcValues = "10,20,30,40,50,60,70,80,90"
)
```

## C
```{r}
# Gerar amostra
jmv::descriptives(
    vars = vars (C, rotinas, financas),
    data = dt_MT_SP,
    mode = TRUE,
    variance = TRUE,
    pc = TRUE,
    pcValues = "10,20,30,40,50,60,70,80,90"
)
```

# Normas amostra dividida por sexo{.tabset .tabset-fade}

## R
```{r}
# Gerar amostra
jmv::descriptives(
    formula = R + manual + natureza + tecnologia + seguranca + esportes ~ Sexo,
    data = dt_MT_SP,
    mode = TRUE,
    variance = TRUE,
    pc = TRUE,
    pcValues = "10,20,30,40,50,60,70,80,90"
)
```

## I
```{r}
# Gerar amostra
jmv::descriptives(
    formula = I + cie_naturais + cie_humanas ~ Sexo,
    data = dt_MT_SP,
    mode = TRUE,
    variance = TRUE,
    pc = TRUE,
    pcValues = "10,20,30,40,50,60,70,80,90"
)
```

## A
```{r}
# Gerar amostra
jmv::descriptives(
    formula = A + criacao + performance + exibicao ~ Sexo,
    data = dt_MT_SP,
    mode = TRUE,
    variance = TRUE,
    pc = TRUE,
    pcValues = "10,20,30,40,50,60,70,80,90"
)
```

## S
```{r}
# Gerar amostra
jmv::descriptives(
    formula = S + aconselhamento + educacao + saude + familia + altruismo + religiosidade ~ Sexo,
    data = dt_MT_SP,
    mode = TRUE,
    variance = TRUE,
    pc = TRUE,
    pcValues = "10,20,30,40,50,60,70,80,90"
)
```

## E
```{r}
# Gerar amostra
jmv::descriptives(
    formula = E + lideranca + organizacional + politica + vendas ~ Sexo,
    data = dt_MT_SP,
    mode = TRUE,
    variance = TRUE,
    pc = TRUE,
    pcValues = "10,20,30,40,50,60,70,80,90"
)
```

## C
```{r}
# Gerar amostra
jmv::descriptives(
    formula = C + rotinas + financas ~ Sexo,
    data = dt_MT_SP,
    mode = TRUE,
    variance = TRUE,
    pc = TRUE,
    pcValues = "10,20,30,40,50,60,70,80,90"
)
```

# AFE - EM {.tabset .tabset-fade}
## Realista
```{r eval=TRUE, echo=FALSE}
# rodar AFE
efa_hol_R <- lavaan::efa(
  dt_SP_2019, 
  nfactors = 5, 
  rotation = "oblimin", 
  ov.names= c(
    "EIB1",
    "EIB23",
    "EIB45",
    "EIB67_12",
    "EIB89_34",
    "EIB2",
    "EIB24",
    "EIB46",
    "EIB68_13",
    "EIB90_35",
    "EIB3",
    "EIB25",
    "EIB47",
    "EIB69_14",
    "EIB91_36",
    "EIB4",
    #"EIB26",
    "EIB48",
    "EIB70_15",
    #"EIB92_37",
    "EIB5",
    "EIB27",
    "EIB49",
    "EIB71_16",
    "EIB93_38"
  ), 
  ordered=TRUE
)

# ver resultados
summary(efa_hol_R, standardized = TRUE, fit.measures = TRUE, cutoff = 0.001)
fitMeasures(efa_hol_R)
```

## Investigativo
```{r eval=TRUE, echo=FALSE}
# rodar AFE
efa_hol_I <- lavaan::efa(
  dt_SP_2019, 
  nfactors = 2, 
  rotation = "oblimin", 
  ov.names= c(
    "EIB6",
    "EIB28",
    "EIB50",
    "EIB72_17",
    "EIB94_39",
    "EIB7",
    "EIB29",
    "EIB51",
    "EIB73_18",
    "EIB95_40"
  ), 
  ordered=TRUE
)

# ver resultados
summary(efa_hol_I, standardized = TRUE, fit.measures = TRUE, cutoff = 0.001)
fitMeasures(efa_hol_I)
```

## Artístico
```{r eval=TRUE, echo=FALSE}
# rodar AFE
efa_hol_A <- lavaan::efa(
  dt_SP_2019, 
  nfactors = 3, 
  rotation = "oblimin", 
  ov.names= c(
    "EIB8",
    "EIB30",
    "EIB52",
    "EIB74_19",
    "EIB96_41",
    "EIB9",
    "EIB31",
    "EIB53",
    "EIB75_20",
    "EIB97_42",
    "EIB10",
    "EIB32",
    "EIB54",
    "EIB76_21",
    "EIB98_43"
  ), 
  ordered=TRUE
)

# ver resultados
summary(efa_hol_A, standardized = TRUE, fit.measures = TRUE, cutoff = 0.001)
fitMeasures(efa_hol_A)
```

## Social
```{r eval=TRUE, echo=FALSE}
# rodar AFE
efa_hol_S <- lavaan::efa(
  dt_SP_2019, 
  nfactors = 6, 
  rotation = "oblimin", 
  ov.names= c(
    "EIB11",
    "EIB33",
    "EIB55",
    "EIB77_22",
    "EIB99_44",
    "EIB12",
    "EIB34",
    "EIB56_1",
    "EIB78_23",
    "EIB100_45",
    "EIB13",
    "EIB35",
    "EIB57_2",
    "EIB79_24",
    "EIB101_46",
    "EIB14",
    "EIB36",
    "EIB58_3",
    "EIB80_25",
    "EIB102_47",
    "EIB15",
    "EIB37",
    "EIB59_4",
    "EIB81_26",
    "EIB103_48",
    "EIB16",
    "EIB38",
    "EIB60_5",
    "EIB82_27",
    "EIB104_49"
  ), 
  ordered=TRUE
)

# ver resultados
summary(efa_hol_S, standardized = TRUE, fit.measures = TRUE, cutoff = 0.001)
fitMeasures(efa_hol_S)
```

## Empreendedor
```{r eval=TRUE, echo=FALSE}
# rodar AFE
efa_hol_E <- lavaan::efa(
  dt_SP_2019, 
  nfactors = 4, 
  rotation = "oblimin", 
  ov.names= c(
    "EIB17",
    "EIB39",
    "EIB61_6",
    "EIB83_28",
    "EIB105_50",
    "EIB18",
    "EIB40",
    "EIB62_7",
    "EIB84_29",
    "EIB106_51",
    "EIB19",
    "EIB41",
    "EIB63_8",
    "EIB85_30",
    "EIB107_52",
    "EIB20",
    "EIB42",
    "EIB64_9",
    "EIB86_31",
    "EIB108_53"
  ), 
  ordered=TRUE
)

# ver resultados
summary(efa_hol_E, standardized = TRUE, fit.measures = TRUE, cutoff = 0.001)
fitMeasures(efa_hol_E)
```

## Convencional
```{r eval=TRUE, echo=FALSE}
# rodar AFE
efa_hol_C <- lavaan::efa(
  dt_SP_2019, 
  nfactors = 2, 
  rotation = "oblimin", 
  ov.names= c(
    "EIB21",
    "EIB43",
    "EIB65_10",
    "EIB87_32",
    "EIB109_54",
    "EIB22",
    "EIB44",
    "EIB66_11",
    "EIB88_33",
    "EIB110_55"
  ), 
  ordered=TRUE
)

# ver resultados
summary(efa_hol_C, standardized = TRUE, fit.measures = TRUE, cutoff = 0.001)
fitMeasures(efa_hol_C)
```

# AFC - EM + 9º ano {.tabset .tabset-fade}
## Realista
```{r eval=TRUE, echo=FALSE}
dt_MT_SP_AFC <- bind_rows(list(MT = dt_MT_2022_limpo, SP = dt_SP_2019), .id = "banco")


# modelo
modelo_R <- '
manual =~ NA*EIB1 + EIB23 + EIB45 + EIB67_12 + EIB89_34
manual ~~ 1*manual
natureza =~ NA*EIB2 + EIB24 + EIB46 + EIB68_13 + EIB90_35
natureza ~~ 1*natureza
tecnologia =~ NA*EIB3 + EIB25 + EIB47 + EIB69_14 + EIB91_36
tecnologia ~~ 1*tecnologia
seguranca =~ NA*EIB4 + EIB48 + EIB70_15
seguranca ~~ 1*seguranca
esporte =~ NA*EIB5 + EIB27 +  EIB49 + EIB71_16 + EIB93_38
esporte ~~ 1*esporte
'

# rodar AFC
cfa_hol_R <- sem(
  dt_MT_SP_AFC,
  model = modelo_R,
  rotation = "oblimin", 
  ordered=TRUE
)

# ver resultados
summary(cfa_hol_R, standardized = TRUE, fit.measures = TRUE)
```

## Investigativo
```{r eval=TRUE, echo=FALSE}
# modelo
modelo_I <- '
cie_naturais =~ NA*EIB6 + EIB28 + EIB50 + EIB72_17 + EIB94_39
cie_naturais ~~ 1*cie_naturais
cie_humanas =~ NA*EIB7 + EIB29 + EIB51 + EIB73_18 + EIB95_40
cie_humanas ~~ 1*cie_humanas
'

# rodar AFC
cfa_hol_I <- sem(
  dt_MT_SP_AFC,
  model = modelo_I,
  rotation = "oblimin", 
  ordered=TRUE
)

# ver resultados
summary(cfa_hol_I, standardized = TRUE, fit.measures = TRUE)
```

## Artístico
```{r eval=TRUE, echo=FALSE}
# modelo
modelo_A <- '
criacao =~ NA*EIB8 + EIB30 + EIB52 + EIB74_19 + EIB96_41
criacao ~~ 1*criacao
performance =~ NA*EIB9 + EIB31 + EIB53 + EIB75_20 + EIB97_42
performance ~~ 1*performance
exibicao =~ NA*EIB10 + EIB32 + EIB54 + EIB76_21 + EIB98_43
exibicao ~~ 1*exibicao
'

# rodar AFC
cfa_hol_A <- sem(
  dt_MT_SP_AFC,
  model = modelo_A,
  rotation = "oblimin", 
  ordered=TRUE
)

# ver resultados
summary(cfa_hol_A, standardized = TRUE, fit.measures = TRUE)
```

## Social
```{r eval=TRUE, echo=FALSE}
# modelo
modelo_S <- '
aconselhamento =~ NA*EIB11 + EIB33 + EIB55 + EIB77_22 + EIB99_44
aconselhamento ~~ 1*aconselhamento
educacao =~ NA*EIB12 + EIB34 + EIB56_1 + EIB78_23 + EIB100_45
educacao ~~ 1*educacao
saude =~ NA*EIB13 + EIB35 + EIB57_2 + EIB79_24 + EIB101_46
saude ~~ 1*saude
familia =~ NA*EIB14 + EIB36 + EIB58_3 + EIB80_25 + EIB102_47
familia ~~ 1*familia
altruismo =~ NA*EIB15 + EIB37 + EIB59_4 + EIB81_26 + EIB103_48
altruismo ~~ 1*altruismo
religiosidade =~ NA*EIB16 + EIB38 + EIB60_5 + EIB82_27 + EIB104_49
religiosidade ~~ 1*religiosidade
'

# rodar AFC
cfa_hol_S <- sem(
  dt_MT_SP_AFC,
  model = modelo_S,
  rotation = "oblimin", 
  ordered=TRUE
)

# ver resultados
summary(cfa_hol_S, standardized = TRUE, fit.measures = TRUE)
```

## Empreendedor
```{r eval=TRUE, echo=FALSE}
# modelo
modelo_E <- '
lideranca =~ NA*EIB17 + EIB39 + EIB61_6 + EIB83_28 + EIB105_50
lideranca ~~ 1*lideranca
organizacional =~ NA*EIB18 + EIB40 + EIB62_7 + EIB84_29 + EIB106_51
organizacional ~~ 1*organizacional
politica =~ NA*EIB19 + EIB41 + EIB63_8 + EIB85_30 + EIB107_52
politica ~~ 1*politica
vendas =~ NA*EIB20 + EIB42 + EIB64_9 + EIB86_31 + EIB108_53
vendas ~~ 1*vendas
'

# rodar AFC
cfa_hol_E <- sem(
  dt_MT_SP_AFC,
  model = modelo_E,
  rotation = "oblimin", 
  ordered=TRUE
)

# ver resultados
summary(cfa_hol_E, standardized = TRUE, fit.measures = TRUE)
```
## Empreendedor - EM
```{r eval=TRUE, echo=FALSE}
# modelo
modelo_E <- '
lideranca =~ NA*EIB17 + EIB39 + EIB61_6 + EIB83_28 + EIB105_50
lideranca ~~ 1*lideranca
organizacional =~ NA*EIB18 + EIB40 + EIB62_7 + EIB84_29 + EIB106_51
organizacional ~~ 1*organizacional
politica =~ NA*EIB19 + EIB41 + EIB63_8 + EIB85_30 + EIB107_52
politica ~~ 1*politica
vendas =~ NA*EIB20 + EIB42 + EIB64_9 + EIB86_31 + EIB108_53
vendas ~~ 1*vendas
'

# rodar AFC
cfa_hol_E <- sem(
  dt_SP_2019,
  model = modelo_E,
  rotation = "oblimin", 
  ordered=TRUE
)

# ver resultados
summary(cfa_hol_E, standardized = TRUE, fit.measures = TRUE)
```

## Convencional
```{r eval=TRUE, echo=FALSE}
# modelo
modelo_C <- '
rotinas =~ NA*EIB21 + EIB43 + EIB65_10 + EIB87_32 + EIB109_54
rotinas ~~ 1*rotinas
financas =~ NA*EIB22 + EIB44 + EIB66_11 + EIB88_33 + EIB110_55
financas ~~ 1*financas
'

# rodar AFC
cfa_hol_C <- sem(
  dt_MT_SP_AFC,
  model = modelo_C,
  rotation = "oblimin", 
  ordered=TRUE
)

# ver resultados
summary(cfa_hol_C, standardized = TRUE, fit.measures = TRUE)
```



```{r eval=TRUE, echo=FALSE}
# modelo
modelo_R <- '
manual =~ NA*EIB1 + EIB23 + EIB45 + EIB67_12 + EIB89_34
manual ~~ 1*manual
natureza =~ NA*EIB2 + EIB24 + EIB46 + EIB68_13 + EIB90_35
natureza ~~ 1*natureza
tecnologia =~ NA*EIB3 + EIB25 + EIB47 + EIB69_14 + EIB91_36
tecnologia ~~ 1*tecnologia
seguranca =~ NA*EIB4 + EIB48 + EIB70_15
seguranca ~~ 1*seguranca
esporte =~ NA*EIB5 + EIB27 +  EIB49 + EIB71_16 + EIB93_38
esporte ~~ 1*esporte
'

# rodar AFC
cfa_hol_R <- sem(
  dt_MT_SP_AFC,
  model = modelo_R,
  rotation = "oblimin", 
  ordered=TRUE
)

# ver resultados
summary(cfa_hol_R, standardized = TRUE, fit.measures = TRUE)
```

# AFE - EM E 9º ano {.tabset .tabset-fade}
## Realista
```{r eval=TRUE, echo=FALSE}
# rodar AFE
efa_hol_R <- lavaan::efa(
  dt_MT_SP_AFC, 
  nfactors = 5, 
  rotation = "oblimin", 
  ov.names= c(
    "EIB1",
    "EIB23",
    "EIB45",
    "EIB67_12",
    "EIB89_34",
    "EIB2",
    "EIB24",
    "EIB46",
    "EIB68_13",
    "EIB90_35",
    "EIB3",
    "EIB25",
    "EIB47",
    "EIB69_14",
    "EIB91_36",
    "EIB4",
    #"EIB26",
    "EIB48",
    "EIB70_15",
    #"EIB92_37",
    "EIB5",
    "EIB27",
    "EIB49",
    "EIB71_16",
    "EIB93_38"
  ), 
  ordered=TRUE
)

# ver resultados
summary(efa_hol_R, standardized = TRUE, fit.measures = TRUE, cutoff = 0.001)
fitMeasures(efa_hol_R)
```

## Investigativo
```{r eval=TRUE, echo=FALSE}
# rodar AFE
efa_hol_I <- lavaan::efa(
  dt_MT_SP_AFC, 
  nfactors = 2, 
  rotation = "oblimin", 
  ov.names= c(
    "EIB6",
    "EIB28",
    "EIB50",
    "EIB72_17",
    "EIB94_39",
    "EIB7",
    "EIB29",
    "EIB51",
    "EIB73_18",
    "EIB95_40"
  ), 
  ordered=TRUE
)

# ver resultados
summary(efa_hol_I, standardized = TRUE, fit.measures = TRUE, cutoff = 0.001)
fitMeasures(efa_hol_I)
```

## Artístico
```{r eval=TRUE, echo=FALSE}
# rodar AFE
efa_hol_A <- lavaan::efa(
  dt_MT_SP_AFC, 
  nfactors = 3, 
  rotation = "oblimin", 
  ov.names= c(
    "EIB8",
    "EIB30",
    "EIB52",
    "EIB74_19",
    "EIB96_41",
    "EIB9",
    "EIB31",
    "EIB53",
    "EIB75_20",
    "EIB97_42",
    "EIB10",
    "EIB32",
    "EIB54",
    "EIB76_21",
    "EIB98_43"
  ), 
  ordered=TRUE
)

# ver resultados
summary(efa_hol_A, standardized = TRUE, fit.measures = TRUE, cutoff = 0.001)
fitMeasures(efa_hol_A)
```

## Social
```{r eval=TRUE, echo=FALSE}
# rodar AFE
efa_hol_S <- lavaan::efa(
  dt_MT_SP_AFC, 
  nfactors = 6, 
  rotation = "oblimin", 
  ov.names= c(
    "EIB11",
    "EIB33",
    "EIB55",
    "EIB77_22",
    "EIB99_44",
    "EIB12",
    "EIB34",
    "EIB56_1",
    "EIB78_23",
    "EIB100_45",
    "EIB13",
    "EIB35",
    "EIB57_2",
    "EIB79_24",
    "EIB101_46",
    "EIB14",
    "EIB36",
    "EIB58_3",
    "EIB80_25",
    "EIB102_47",
    "EIB15",
    "EIB37",
    "EIB59_4",
    "EIB81_26",
    "EIB103_48",
    "EIB16",
    "EIB38",
    "EIB60_5",
    "EIB82_27",
    "EIB104_49"
  ), 
  ordered=TRUE
)

# ver resultados
summary(efa_hol_S, standardized = TRUE, fit.measures = TRUE, cutoff = 0.001)
fitMeasures(efa_hol_S)
```

## Empreendedor
```{r eval=TRUE, echo=FALSE}
# rodar AFE
efa_hol_E <- lavaan::efa(
  dt_MT_SP_AFC, 
  nfactors = 4, 
  rotation = "oblimin", 
  ov.names= c(
    "EIB17",
    "EIB39",
    "EIB61_6",
    "EIB83_28",
    "EIB105_50",
    "EIB18",
    "EIB40",
    "EIB62_7",
    "EIB84_29",
    "EIB106_51",
    "EIB19",
    "EIB41",
    "EIB63_8",
    "EIB85_30",
    "EIB107_52",
    "EIB20",
    "EIB42",
    "EIB64_9",
    "EIB86_31",
    "EIB108_53"
  ), 
  ordered=TRUE
)

# ver resultados
summary(efa_hol_E, standardized = TRUE, fit.measures = TRUE, cutoff = 0.001)
fitMeasures(efa_hol_E)
```




## Convencional
```{r eval=TRUE, echo=FALSE}
# rodar AFE
efa_hol_C <- lavaan::efa(
  dt_MT_SP_AFC, 
  nfactors = 2, 
  rotation = "oblimin", 
  ov.names= c(
    "EIB21",
    "EIB43",
    "EIB65_10",
    "EIB87_32",
    "EIB109_54",
    "EIB22",
    "EIB44",
    "EIB66_11",
    "EIB88_33",
    "EIB110_55"
  ), 
  ordered=TRUE
)

# ver resultados
summary(efa_hol_C, standardized = TRUE, fit.measures = TRUE, cutoff = 0.001)
fitMeasures(efa_hol_C)
```


# Invariância 9º ano x EM
We consider that the instrument is not invariant if it meets the following variation criteria (Δ) in the fit indices from one model to another, following a hierarchical order of constraints (i.e., configural, threshold, metric, and scalar): ΔCFI ≤ - .010, ΔRMSEA ≥ .015, ΔSRMR ≥ .010, ΔNon-centrality Index (McDonald's NCI) ≤ -.020 and ΔGamma hat ≤ -.008 (Chen, 2007; Cheung & Rensvold, 2002; Svetina et al., 2019). 
## R
```{r}
########### MULTIPLE-GROUP INVARIANCE WITH CATEGORICAL VARIABLES ###################
###Grau de escolaridade###

#CONFIGURAL
configural_escolaridade <- measEq.syntax(
  configural.model=modelo_R, 
  data=dt_MT_SP_AFC,
  ordered=T, estimator="WLSMV",
  group="banco", return.fit=TRUE
)
# summary(configural_escolaridade, fit.measures=T, standardized=T)

#THRESHOLDS 
thresholds_escolaridade <-measEq.syntax(configural.model=modelo_R, data=dt_MT_SP_AFC,
                           ordered=TRUE, estimator="WLSMV",
                           group="banco", return.fit=TRUE,
                           group.equal="thresholds")
# summary(thresholds_escolaridade, fit.measures=T, standardized=T)

#METRICA
metrica_escolaridade <- measEq.syntax(configural.model=modelo_R, data=dt_MT_SP_AFC,
                         ordered=TRUE, estimator="WLSMV",
                         group="banco", return.fit=TRUE,
                         group.equal=c("thresholds","loadings"))
# summary(metrica_escolaridade, fit.measures=T, standardized=T)

#ESCALAR
escalar_escolaridade <- measEq.syntax(configural.model=modelo_R, data=dt_MT_SP_AFC,
                         ordered=TRUE, estimator="WLSMV",
                         group="banco", return.fit=TRUE,
                         group.equal=c("thresholds","loadings", 
                                       "intercepts"))
# summary(escalar_escolaridade, fit.measures=T, standardized=T)


#comparar os modelos de invariância
invariancia_escolaridade <- compareFit(configural_escolaridade, thresholds_escolaridade, metrica_escolaridade, escalar_escolaridade)
summary(invariancia_escolaridade, 
        fit.measures=c("cfi.scaled","rmsea.scaled","srmr","mfi"))

#Gamma hat
moreFitIndices(configural_escolaridade, fit.measures="gammaHat.scaled")
moreFitIndices(thresholds_escolaridade, fit.measures="gammaHat.scaled")
moreFitIndices(metrica_escolaridade, fit.measures="gammaHat.scaled")
moreFitIndices(escalar_escolaridade, fit.measures="gammaHat.scaled")
```

## E
```{r}
########### MULTIPLE-GROUP INVARIANCE WITH CATEGORICAL VARIABLES ###################
###Grau de escolaridade###

#CONFIGURAL
configural_escolaridade <- measEq.syntax(
  configural.model=modelo_E, 
  data=dt_MT_SP_AFC,
  ordered=T, estimator="WLSMV",
  group="banco", return.fit=TRUE
)
# summary(configural_escolaridade, fit.measures=T, standardized=T)

#THRESHOLDS 
thresholds_escolaridade <-measEq.syntax(configural.model=modelo_E, data=dt_MT_SP_AFC,
                           ordered=TRUE, estimator="WLSMV",
                           group="banco", return.fit=TRUE,
                           group.equal="thresholds")
# summary(thresholds_escolaridade, fit.measures=T, standardized=T)

#METRICA
metrica_escolaridade <- measEq.syntax(configural.model=modelo_E, data=dt_MT_SP_AFC,
                         ordered=TRUE, estimator="WLSMV",
                         group="banco", return.fit=TRUE,
                         group.equal=c("thresholds","loadings"))
# summary(metrica_escolaridade, fit.measures=T, standardized=T)

#ESCALAR
escalar_escolaridade <- measEq.syntax(configural.model=modelo_E, data=dt_MT_SP_AFC,
                         ordered=TRUE, estimator="WLSMV",
                         group="banco", return.fit=TRUE,
                         group.equal=c("thresholds","loadings", 
                                       "intercepts"))
# summary(escalar_escolaridade, fit.measures=T, standardized=T)


#comparar os modelos de invariância
invariancia_escolaridade <- compareFit(configural_escolaridade, thresholds_escolaridade, metrica_escolaridade, escalar_escolaridade)
summary(invariancia_escolaridade, 
        fit.measures=c("cfi.scaled","rmsea.scaled","srmr","mfi"))

#Gamma hat
moreFitIndices(configural_escolaridade, fit.measures="gammaHat.scaled")
moreFitIndices(thresholds_escolaridade, fit.measures="gammaHat.scaled")
moreFitIndices(metrica_escolaridade, fit.measures="gammaHat.scaled")
moreFitIndices(escalar_escolaridade, fit.measures="gammaHat.scaled")
```


Ver questão de correlação acima de 1 entre liderança e organizacional


Fazer o teste de fixar o item e ver se a variância é significativa