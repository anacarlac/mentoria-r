---
title: "Paper RIASEC x CSE"
author: "eduLab21Ⓡ (Ana C e Gustavo)"
date: "Relatório produzido em: `r format(Sys.time(), '%d %B, %Y')`"
output: html_document
---

```{r setup, warning=FALSE, message=FALSE, include=FALSE}
knitr::opts_chunk$set(warning=FALSE, message=FALSE)
```

```{r pacotes_db, echo= FALSE}
# Pacotes -----------------------------------------------------------------
library(readxl)
library(dplyr)
library(holland)
library(corrplot) # https://cran.r-project.org/web/packages/corrplot/vignettes/corrplot-intro.html
library(psych)
library(summarytools)
library(Hmisc)
library(sjPlot)
library(lavaan)
library(lavaanPlot)
library(sjmisc)
library(formattable)
library(tidyverse)
library(lsr)
library(broom)
library(qgraph)
library(ggthemes)
library(hrbrthemes)

```

```{r echo= FALSE, eval=FALSE}
# NÃO RODAR ---------------------------------------------------------------
# Importar banco de dados e criar índices de interesses secundários
# dt_hol <- readRDS("data/dt_hol.RDS")
# 
# dt_hol2 <- dt_hol
# 
# # criar as variáveis para os índices de diferenciação
# dt_hol2$holland_Difer1<-NA
# dt_hol2$holland_Difer2<-NA
# dt_hol2$holland_Difer3<-NA
# dt_hol2$holland_Difer4<-NA
# dt_hol2$holland_Difer5<-NA
# dt_hol2$holland_Difer6<-NA
# dt_hol2$holland_Difer7<-NA
# dt_hol2$holland_Elev <-NA
# 
# 
# # calcular os índices de diferenciação e elevação
# # names(dt_hol)
# for (i in 1:nrow(dt_hol2)) {
#  dt_hol2[i,577]<- dif_7_holland(as.numeric(dt_hol[i,297:302]),ind="DI1")
#  dt_hol2[i,578]<- dif_7_holland(as.numeric(dt_hol[i,297:302]),ind="DI2")
#  dt_hol2[i,579]<- dif_7_holland(as.numeric(dt_hol[i,297:302]),ind="DI3")
#  dt_hol2[i,580]<- dif_7_holland(as.numeric(dt_hol[i,297:302]),ind="DI4")
#  dt_hol2[i,581]<- dif_7_holland(as.numeric(dt_hol[i,297:302]),ind="DI5")
#  dt_hol2[i,572]<- dif_7_holland(as.numeric(dt_hol[i,297:302]),ind="DI6")
#  dt_hol2[i,573]<- dif_7_holland(as.numeric(dt_hol[i,297:302]),ind="DI7")
# }
# 
# dt_hol2$holland_Elev<-apply(dt_hol2[,297:302],1, mean)
# 
# write.csv2(dt_hol2, file="data/dt_hol2.csv")
# saveRDS(dt_hol2, file = "data/dt_hol2.rds")
```

```{r include = FALSE}
# RODAR A PARTIR DAQUI
# Importar o banco de dados

# O banco de dados contém respostas de estudantes que responderam aos cadernos A, C, H, J e apresentaram menos de 15 respostas repetidas
# dt_hol <- bd_sp_2021 %>%  
#   filter(booklet %in% c("bkl_A", "bkl_C", "bkl_H", "bkl_J")) %>%
#   filter(long_str < 15) 

# importar banco com RIASEC
dt_hol2 <- readRDS("data/dt_hol2.RDS")

# importar o dicionário
dic_geral <- read_excel("dic/dic_geral.xlsx", sheet = "dic_item")

# dicionário RIASEC
dic_hol <- dic_geral %>% 
  filter(tet_name == "18rest adaptado")
  
it_hol <- dic_hol$coditem

dic_hol2 <-  tibble(
    coditem =dic_hol$coditem,
    scale = paste(dic_hol$scale),
    pole = dic_hol$pole,
    item_text = dic_hol$item_text_pt, #checar nome da variável
    #test = dic_sal$Instrumento, #checar nome da variável
    #seman_pairs = item_dic_sal$seman_pair #add semantic pairs para correção por ACQ
    )

# importar o nome das facetas SENNA
nomes_facetas<- read_excel("dic/nomes_facetas.xlsx")


```

## What do we want to answer with this report?
- Objectives: *What explains the clarity and flexibility of interests profiles in RIASEC?* To answer the question, firstly, we aim to explore the relationship between SEMS and RIASEC types and patterns using students’ perceptions about their socioemotional skills and their preferences over RIASEC activities. Clarity will be investigated throught the concepto f differentiation. Flexibility will be investigate through the concept of elevation. Then, secondly, we aim to investigate how much of elevation and differentiation is explained by the socioemotional development.

</br>

## Method
- Data was collected in schools in the Southeast of Brazil in 2021 (São Paulo; SP 2021). A total of N = 234.857 participants answered the survey with Senna and 18-rest. 
- The study was designed with Balanced Incomplete Blocks (BIB). Twelve booklets were created and each participant answered **only one booklet**. Each booklet had the full set of items of socio-emotional skills and a set of items from other scales. 18-rest items were available in four booklets: A (1), C(3), H(8) e J(10). The distribution of items and participants in each booklet is presented in the table below. 

```{r echo=FALSE}
options(width = 200)
table_booklets <- dt_hol2 %>% 
 group_by(booklet, serie_ano) %>% 
 tally()

DT::datatable(table_booklets)
```

</br>

## Results summary

</br>

**Method**
- Sample size is adequate. We do not have the age variable; however, the school years are very distant between themselves, so overlap because of age-grade distortion is less likely to happen.
- Method: Senna has good psychometric properties. 18-rest v2 has good psychometric properties considering the amount of items available per scale. Secondary concepts are calculaed according to previous studies.

</br>

**Are RIASEC and SEMS average scores and SD similar to other studies?**
Yes. Results about differences between boys and girls across school years are coherent with previous studies. 

</br>

*RIASEC:* Boys are more interested in R activities and girls are more interested in A and S activities. In Realistic activities, the difference from boys and girls happens since 5th grade; although boys R interests increase with time, girls R interests decrease.In Investigative activities, the differences disappear in the 3rd year. Boys and girls interests in I activities decrease across time. Girls are significantly more interest in A activities than boys; although both boys and girls tend to become less interest in A activities over time. Girls are more interested in S activities than boys; they tend to increase their interest in S activities over time and boys present a quadratic relationship with S activities. For E interests, boys and girls have significant differences but Cohen’s d shows a week effect size. Girls abd boys become more interested in E activities over time. For C interests, boys and girls have significant differences but Cohen’s d shows a week effect size. Girls abd boys become more interested in C activities over time.

</br>

*Senna:*  Moderate effects sizes are found for boys and girls differences in O and N. Girls perceived themselves as less developed in N and more developed in O. Key results: Girls reported higher levels of A across time and boys presented a quadratic relationship. Effects sizes were small. Both boys and girls reported less C from 5th to 9th grade and then an increase from 9th grade to 3rd year. Girls reported more C than boys in the 3rd year (small effect size). Overall, girls reported less E than boys but differences had a very small effect size. Both boys and girls reported less E from 5th to 9th grade and then an increase from 9th grade to 3rd year. Girls report less Emotional resilience consistently over time with strong effect sizes. Girls report more O over time with small to medium effect sizes. Both boys and girls reported less O from 5th to 9th grade and then an increase from 9th grade to 3rd year. Girls reported more C than boys in the 3rd year.

</br>

**Are differentation and elevation profiles different between boys and girls?**
Mean diferences: Girls’ interest profile is more differentiated profile than boys (d = 0.24). The elevation profile showed significant differences but the effect size was small. Over time, boys and girls have signifcant differences in differentiation; however, both boys and girls’ profiles tend to be more differentiated in the long run. Elevation profile showed a small effect size in 5th grade and girls reported a more elevated profile for interests at this grade. Across time, the difference disappears and effect sizes become smaller.

</br>

**Are SEMS, RIASEC and secondary constructs correlated as expected?**
Correlations: RIASEC correlations follow a quasi-circumplex pattern (i.e. wave) Differentiation correlated more strongly with C and O. Elevation correlated more strongly with C, E and O. About RIASEC: R correlated negatively with Dif7 and S correlated positively and moderately with Dif7. All interests were correlated with Elevation.

</br>

**What explains clarity and flexibility of interests’ profiles?**

</br>

*Differentiation results*
Multiple linear regression: Overall, differentiation levels were lower for boys than girls. And, as students grew up, their differentiation levels increased, especially in the 3rd of High School. All SEMS predicted differentiation levels: O, C and E were the strongest predictors. Emotional resilience was negatively associated with differentiation.
Mean differences of dif7 according to Senna levels: The relationship between O, C, E and A is linear; thus, students with a more differentiated interest profile tend to perceive themselves as more developed in these SEMS domains. However, the same cannot be said to N, which seems to have a quadratic relationship with differentiation. The relationship between N and differentiation seems to decrease from low to emergent level until it comes back at the capable level and increases in the very capable level.
Mean differences of dif7 according to Senna levels and gender:  As shown in the previous results, girls have greater differentiation scores than boys. For girls, A and O have linear relationships with differentiation. For C and E, the relationship is stable in the low and emergent levels and tend to increase in capable and very capable levels. For N, the relationship decreases from low to emergent and starts to increase again at the capable level. For boys and A, C, E and O, the relationship is stable in the low and emergent levels and tend to increase in capable and very capable levels. For N, the relationship decreases from low to emergent and starts to increase again at the capable level.

</br>

**Is the differentiation relationship with SEMS MODERATED by GENDER?**: The relationship for C, E and A is more or less similar for both genders; however, for O and N there is a difference in the estimates. O and E have greater estimates for predicting Diff for girls when compared to boys. N has a negative estimate associated with differentiation for girls. For boys, N is significant although weak effect. School year is a positive estimate for both genders, although stronger for girls. Overall, as students grow up, their interest profile becomes more differentiated. 
**What is the main message from dif7 and SEMS?: ** Students that perceived themselves as better developed in O, C, and E also reported more differentiated profiles. O can help students pursue new interests and new experiences. C can help them to organize and execute their plans in order to achieve their goals, either at school or professionally. E relates to their interest in the outside world and social initiative, which are important skills that will help students to be motivated and engaged in what they set their minds to do. Age maturity was also an important IV given that as students grow older, they report more differentiated profiles, especially in the 3rd year of High School, which can be related to the time when they have to make decisions because they are moving on from the basic education to the workplace or college. Knowing what is interesting or not is also an exercise of self-reflection and access to different experiences, which can be related to why older students have more differentiated profiles. On the moderation effect, gender seems to moderate the relationship between N and differentiation showing that girls’ differentiation profile was negatively associated with Emotional resilience. Boys differentiation profile was very weakly associated with Emotional resilience.

</br>

*Elevation results*
Multiple linear regression: Overall, elevation levels were lower for boys than girls. And, as students grew up, their elevation levels increased, but the difference between 9th grade and 3rd of High School was small. All SEMS predicted elevation levels: O was the strongest predictor followed by E and C (standardized estimates), similar to Bullock and Reardon (2008). Amity was negatively associated with elevation.
Mean differences of dif7 according to Senna levels: The relationship between O, C, E, A and N  is linear; thus, students with a more elevated interest profile tend to perceive themselves as more developed in these SEMS domains.
Mean differences of dif7 according to Senna levels and gender:  Boys and girls have similar elevation scores across domains and have linear relationships for A, C, E and O. For N, there is a slight difference between boys and girls scores across domains in which girls girls presented greater elevation scores than boys for Senna categories in N.

</br>

**Is the elevation relationship with SEMS MODERATED by GENDER?**: O is the strongest IV for both gender, although the greater estimate belongs to boys. Intercepts are similar for both genders; thus, there are no differences between boys and girls elevation profiles. O is the strongest predictor for both genders and estimates are similar for both genders (diffs < 0.05). A is not a significant predictor for girls' differentiation when school year is added. School year is a stronger predictor for boys than girls.
**What is the main message from elevation and SEMS?:** The strongest predictor of elevation is O, followed by E and then C. However, the effect of O is more than double the size of the other two predictors. This shows the importance of being open to new ideas and experiences in the pursue of new interests. The motivation and engagement from E also has an importante role when pursuing new interests because it helps the students to keep mobilizing energy to their activities and interests. Age maturity was also an important predictor; however, the difference was strongest between the 5th grade and the 9th grade. Overall, boys showed smaller scores for elevation, however, the moderation effects were small. 


**Items 18-rest:**

Items r1:26 bd_sp_2021[22:39]

-   r1 Operar máquinas para usinagem de peças./To operate machines.

-   r2 Fazer análises e experimentos em laboratórios./To perform data analyses and experiments in laboratories.

-   r3 Cantar em um coral./To sing in a choir.

-   r4 Estar disponível para ajudar as pessoas./To be available to help people.

-   r11 Negociar com clientes./To negotiate with clients.

-   r18 Arquivar documentos e notas importantes./To organize important documents and notes.

-   r7 Executar manutenções em máquinas e equipamentos./To perform maintanance in machines and other equipment.

-   r8 Explicar fenômenos físicos da natureza./To explain physics and nature phenomena.

-   r9 Apresentar números artísticos para uma plateia./To present artistic pieces to a crowd.

-   r16 Oferecer orientação às pessoas, grupos ou população sobre saúde e bem-estar./To offer well-being and health guidance for people, groups or the population. 

-   r17 Comercializar produtos e serviços./To sell products and services.

-   r22 Fazer a contabilidade de uma empresa./To do accounting in a business. 

-   r27 Projetar o sistema elétrico de uma casa./To think about the eletrical system of a house.

-   r14 Ler artigos e livros científicos./To read scientific papers and books.

-   r15 Participar da criação de cenários teatrais./To participate in the creation of theatre stages.

-   r24 Prestar serviços sociais em comunidades e bairros./To perform social services in communities.

-   r29 Convencer pessoas a comprar um produto./To convince people to buy a product.

-   r26 Inserir informações em uma base de dados./To insert information in a database.

# Sample characteristics

There were N= `r nrow(dt_hol2)` students from N = `r length(unique(dt_hol2$codesc))` public schools in this study. Participants were at 5th grade, 9th grade or 3rd year of High School. Age variable was not collected.

</br>

*Distribution according to gender*

raw.prc contains raw percentage and cum.prc constains cumulative percentage

**Key results**: There is, more or less, the same percentage of girls and boys.
```{r echo=FALSE, out.width="50%"}
#Hmisc::describe(base_holl$idade)
table_gender <- frq(dt_hol2$SEXO)
table_gender <- table_gender %>% 
  as.data.frame() %>% 
  dplyr::select(-variable, -label) %>% 
  dplyr::filter(val %in% c("M","F"))

formattable(table_gender)

```

</br>

*Distribution according to school year*

raw.prc contains raw percentage and cum.prc constains cumulative percentage

**Key results**: There is, more or less, the same percentage of students at grade 5, 9 and in the 3rd year of High School.
```{r echo=FALSE}
table_ano <- frq(dt_hol2$serie_ano)
table_ano <- table_ano %>% 
  as.data.frame() %>% 
  dplyr::select(-variable, -label) %>% 
  dplyr::filter(val %in% c("5º Ano EF","9º Ano EF", "EM-3ª série"))

formattable(table_ano)
```

</br>

# Psychometric properties of RIASEC and Senna

```{r echo = FALSE, include = FALSE}
holl_data <- dt_hol2 %>% 
 select(it_hol) %>% 
 drop_na()

frq(holl_data$r1)
frq(holl_data$r2)
frq(holl_data$r3)
frq(holl_data$r4)
frq(holl_data$r7)
frq(holl_data$r8)
frq(holl_data$r9)
frq(holl_data$r11)
frq(holl_data$r14)
frq(holl_data$r15)
frq(holl_data$r16)
frq(holl_data$r17)
frq(holl_data$r18)
frq(holl_data$r22)
frq(holl_data$r24)
frq(holl_data$r26)
frq(holl_data$r27)
frq(holl_data$r29)

key_list <- list(holl_R = c("r1", "r7", "r27"),
                 holl_I = c("r2", "r8", "r14"),
                 holl_A = c("r3", "r9", "r15"),
                 holl_S = c("r4", "r16", "r24"),
                 holl_E = c("r11", "r17", "r29"),
                 holl_C = c("r18", "r22", "r26")
                 )

holl_data <- dt_hol2 %>% 
 select(it_hol) %>% 
 drop_na()

dt_hol3 <- dt_hol2 %>% 
# select(it_hol) %>% 
 drop_na(it_hol)

holl_scores <- psych::scoreItems(key_list, 
                          holl_data, 
                          totals = TRUE,
                          missing=FALSE, 
                          min = 1, 
                          max = 5, 
                          digits = 2)

dt_hol_final <- cbind(dt_hol3, holl_scores$scores)

dt_hol_final_5 <- dt_hol_final %>% 
 filter(serie == "005")

dt_hol_final_9 <- dt_hol_final %>% 
 filter(serie == "009")

dt_hol_final_11 <- dt_hol_final %>% 
 filter(serie == "011")

```

## RIASEC reliability 
**Domain-level scores have the prefix holl_**
RIASEC scores were calculated using psych::scoreItems. Only participants that answered all questions were considered. Thus, N = 208.471 had RIASEC scores calculated. Each RIASEC scale was calculated using 3 items and the average alpha was ~0.60. After reliability checks, scores were calculated as sum scores.

```{r echo=FALSE, warning=FALSE, message=FALSE}
holl_names <- dt_hol_final %>% 
 select(starts_with("holl_")) %>% 
 colnames()

holl_nitems <- as.data.frame(holl_scores$n.items)
holl_reliability <- as.data.frame(holl_scores$alpha)
holl_reliability <- data.table::transpose(holl_reliability)
holl_reliability<-cbind(holl_nitems, holl_reliability)
holl_reliability<- add_rownames(holl_reliability, var = "Scale")

holl_reliability <- holl_reliability %>% 
  dplyr::filter(Scale %in% holl_names)

holl_reliability <- holl_reliability %>% 
  rename(
    Number_of_Items = 'holl_scores$n.items',
    Alpha = V1
    )

holl_reliability$Alpha <- round(holl_reliability$Alpha,2)

DT::datatable(holl_reliability)

```

</br>

## Secondary concepts
Differentiation and Elevation indices were calculated using the package holland in R. The differentiation index is expressed by Dif7, an index calculated using DI7 Dispersion of interest scores (Healy & Mourton, 1983).

## Senna psychometric properties
Senna scores were calculated at the domain- and facet-level using IRT parameters (PCM).

</br>

# Data distribution

## Overall
```{r echo = FALSE}
table_medias <- dt_hol_final %>% 
 summarise(
  senna_O = mean(O, na.rm=TRUE),
  senna_C = mean(C, na.rm=TRUE),
  senna_E = mean(E, na.rm=TRUE),
  senna_A = mean(A, na.rm=TRUE),
  senna_N = mean(N, na.rm=TRUE),
  riasec_R = mean(holl_R, na.rm=TRUE),
  riasec_I = mean(holl_I, na.rm=TRUE),
  riasec_A = mean(holl_A, na.rm=TRUE),
  riasec_S = mean(holl_S, na.rm=TRUE),
  riasec_E = mean(holl_E, na.rm=TRUE),
  riasec_C = mean(holl_C, na.rm=TRUE),
  riasec_Diff = mean(holland_Difer7, na.rm=TRUE),
  riasec_Elev = mean(holland_Elev, na.rm=TRUE)) %>% 
 pivot_longer(
  cols = senna_O:riasec_Elev,
  names_to = "variables",
  values_to = "value"
 )

table_sd <- dt_hol_final %>% 
 summarise(
  senna_O = sd(O, na.rm=TRUE),
  senna_C = sd(C, na.rm=TRUE),
  senna_E = sd(E, na.rm=TRUE),
  senna_A = sd(A, na.rm=TRUE),
  senna_N = sd(N, na.rm=TRUE),
  riasec_R = sd(holl_R, na.rm=TRUE),
  riasec_I = sd(holl_I, na.rm=TRUE),
  riasec_A = sd(holl_A, na.rm=TRUE),
  riasec_S = sd(holl_S, na.rm=TRUE),
  riasec_E = sd(holl_E, na.rm=TRUE),
  riasec_C = sd(holl_C, na.rm=TRUE),
  riasec_Diff = sd(holland_Difer7, na.rm=TRUE),
  riasec_Elev = sd(holland_Elev, na.rm=TRUE)) %>% 
 pivot_longer(
  cols = senna_O:riasec_Elev,
  names_to = "variables",
  values_to = "value"
 )

table_min <- dt_hol_final %>% 
 summarise(
  senna_O = min(O, na.rm=TRUE),
  senna_C = min(C, na.rm=TRUE),
  senna_E = min(E, na.rm=TRUE),
  senna_A = min(A, na.rm=TRUE),
  senna_N = min(N, na.rm=TRUE),
  riasec_R = min(holl_R, na.rm=TRUE),
  riasec_I = min(holl_I, na.rm=TRUE),
  riasec_A = min(holl_A, na.rm=TRUE),
  riasec_S = min(holl_S, na.rm=TRUE),
  riasec_E = min(holl_E, na.rm=TRUE),
  riasec_C = min(holl_C, na.rm=TRUE),
  riasec_Diff = min(holland_Difer7, na.rm=TRUE),
  riasec_Elev = min(holland_Elev, na.rm=TRUE)) %>% 
 pivot_longer(
  cols = senna_O:riasec_Elev,
  names_to = "variables",
  values_to = "value"
 )

table_max <- dt_hol_final %>% 
 summarise(
  senna_O = max(O, na.rm=TRUE),
  senna_C = max(C, na.rm=TRUE),
  senna_E = max(E, na.rm=TRUE),
  senna_A = max(A, na.rm=TRUE),
  senna_N = max(N, na.rm=TRUE),
  riasec_R = max(holl_R, na.rm=TRUE),
  riasec_I = max(holl_I, na.rm=TRUE),
  riasec_A = max(holl_A, na.rm=TRUE),
  riasec_S = max(holl_S, na.rm=TRUE),
  riasec_E = max(holl_E, na.rm=TRUE),
  riasec_C = max(holl_C, na.rm=TRUE),
  riasec_Diff = max(holland_Difer7, na.rm=TRUE),
  riasec_Elev = max(holland_Elev, na.rm=TRUE)) %>% 
 pivot_longer(
  cols = senna_O:riasec_Elev,
  names_to = "variables",
  values_to = "value"
 )

table_overall <- cbind(table_medias, table_sd, table_min, table_max)
table_overall <- table_overall[,c(1:2,4,6,8)]

table_overall <- table_overall %>% 
  rename(
    Average_score = value,
    SD = value.1,
    Min = value.2,
    Max = value.3
    ) %>% 
 mutate(
  Average_score = round(Average_score, 2),
  SD = round(SD, 2),
  Min = round(Min,2),
  Max = round(Max, 2)
 )

DT::datatable(table_overall)
```

## RIASEC by gender 
- Gender comparison was performed at the domain level.
- Welch's t-test
</br>
- Comparisons were performed in the following order: F-M
- Estimate 1 represents girls' mean score 
- Estimate 2 represents boys' mean score

**Key results**: Boys are more interested in R activities and girls are more interested in A and S activities.

```{r echo=FALSE, warning=FALSE, error=FALSE}
teste1<-t.test(holl_R ~ SEXO, data = dt_hol_final)
#cohensD(holl_R ~ SEXO, data = dt_hol_final) # 0.5851108
teste2<-t.test(holl_I ~ SEXO, data = dt_hol_final)
#cohensD(holl_I ~ SEXO, data = dt_hol_final) # 0.1343585
teste3<-t.test(holl_A ~ SEXO, data = dt_hol_final)
#cohensD(holl_A ~ SEXO, data = dt_hol_final) # 0.4287317
teste4<-t.test(holl_S ~ SEXO, data = dt_hol_final)
#cohensD(holl_S ~ SEXO, data = dt_hol_final) # 0.3632414
teste5<-t.test(holl_E ~ SEXO, data = dt_hol_final)
#cohensD(holl_E ~ SEXO, data = dt_hol_final) # 0.05296161
teste6<-t.test(holl_C ~ SEXO, data = dt_hol_final)
#cohensD(holl_C ~ SEXO, data = dt_hol_final) # 0.002853935

d_cohen<-c(0.58,0.13,0.43,0.36,0.053,0.002)

teste_name <- c("Realistic", "Investigative", "Artistic", "Social", "Enterprising", "Conventional")

tab_holl <- map_df(list(teste1,teste2,teste3,teste4,teste5,teste6), tidy)
tab_holl <- tab_holl %>% 
  dplyr::select(-method, -alternative)

tab_holl <- round(tab_holl,3)
tab_holl$name <- teste_name
tab_holl$cohen_d<-d_cohen

tab_holl <- tab_holl[, c(9,1,2,3,10,4,5,6,7,8)]

formattable(tab_holl)

```

</br>

### RIASEC gender comparison in boxplots 

</br>

```{r echo=FALSE, message=FALSE, warning=FALSE, fig.show="hold", out.width="50%"}
ggplot(dt_hol_final, aes(x=SEXO, y=holl_R, fill=SEXO)) + 
  geom_boxplot()+
  labs(title="Realist type",x="Gender", y = "Realistic score") +
  theme_minimal() +
  scale_fill_brewer(palette="RdBu")

ggplot(dt_hol_final, aes(x=SEXO, y=holl_I, fill=SEXO)) + 
  geom_boxplot()+
  labs(title="Investigative type",x="Gender", y = "Investigative score") +
  theme_minimal() +
  scale_fill_brewer(palette="RdBu")
```

```{r echo=FALSE, message=FALSE, warning=FALSE,  fig.show="hold", out.width="50%"}
ggplot(dt_hol_final, aes(x=SEXO, y=holl_A, fill=SEXO)) + 
  geom_boxplot()+
  labs(title="Artistic type",x="Gender", y = "Artistic score") +
  theme_minimal() +
  scale_fill_brewer(palette="RdBu")

ggplot(dt_hol_final, aes(x=SEXO, y=holl_S, fill=SEXO)) + 
  geom_boxplot()+
  labs(title="Social type",x="Gender", y = "Social score") +
  theme_minimal() +
  scale_fill_brewer(palette="RdBu")
```

```{r echo=FALSE, message=FALSE, warning=FALSE, fig.show="hold", out.width="50%"}
ggplot(dt_hol_final, aes(x=SEXO, y=holl_E, fill=SEXO)) + 
  geom_boxplot()+
  labs(title="Enterprising type",x="Gender", y = "Enterprising score") +
  theme_minimal() +
  scale_fill_brewer(palette="RdBu")

ggplot(dt_hol_final, aes(x=SEXO, y=holl_C, fill=SEXO)) + 
  geom_boxplot()+
  labs(title="Conventional type",x="Gender", y = "Conventional score") +
  theme_minimal() +
  scale_fill_brewer(palette="RdBu")
```

</br>

## RIASEC by gender and school year
- Gender comparison was performed at the domain level.
- Welch's t-test
</br>
- Comparisons were performed in the following order *within school year*: F-M
- Estimate 1 represents girls' mean score 
- Estimate 2 represents boys' mean score

**Key results:** In Realistic activities, the difference from boys and girls happens since 5th grade; although boys R interests increase with time, girls R interests decrease.In Investigative activities, the differences disappear in the 3rd year. Boys and girls interests in I activities decrease across time. Girls are significantly more interest in A activities than boys; although both boys and girls tend to become less interest in A activities over time. Girls are more interested in S activities than boys; they tend to increase their interest in S activities over time and boys present a quadratic relationship with S activities. For E interests, boys and girls have significant differences but Cohen's d shows a week effect size. Girls abd boys become more interested in E activities over time. For C interests, boys and girls have significant differences but Cohen's d shows a week effect size. Girls abd boys become more interested in C activities over time.

```{r echo=FALSE, warning=FALSE, error=FALSE}
# 5th grade
teste1_5<-t.test(holl_R ~ SEXO, data = dt_hol_final_5)
#cohensD(holl_R ~ SEXO, data = dt_hol_final_5) # 0.214945
teste2_5<-t.test(holl_I ~ SEXO, data = dt_hol_final_5)
#cohensD(holl_I ~ SEXO, data = dt_hol_final_5) # 0.1595489
teste3_5<-t.test(holl_A ~ SEXO, data = dt_hol_final_5)
#cohensD(holl_A ~ SEXO, data = dt_hol_final_5) # 0.4411337
teste4_5<-t.test(holl_S ~ SEXO, data = dt_hol_final_5)
#cohensD(holl_S ~ SEXO, data = dt_hol_final_5) # 0.2078415
teste5_5<-t.test(holl_E ~ SEXO, data = dt_hol_final_5)
#cohensD(holl_E ~ SEXO, data = dt_hol_final_5) # 0.0321503
teste6_5<-t.test(holl_C ~ SEXO, data = dt_hol_final_5)
#cohensD(holl_C ~ SEXO, data = dt_hol_final_5) # 0.02426844

d_cohen_5<-c(0.21,0.16,0.44,0.21,0.03,0.02)

teste_name_5 <- c("Realistic", "Investigative", "Artistic", "Social", "Enterprising", "Conventional")

tab_holl_5 <- map_df(list(teste1_5,teste2_5,teste3_5,teste4_5,teste5_5,teste6_5), tidy)
tab_holl_5 <- tab_holl_5 %>% 
  dplyr::select(-method, -alternative)

tab_holl_5 <- round(tab_holl_5,3)
tab_holl_5$name <- teste_name_5
tab_holl_5$cohen_d<-d_cohen_5

tab_holl_5 <- tab_holl_5[, c(9,1,2,3,10,4,5,6,7,8)]
tab_holl_5$school_year <- "5th grade"

# 9th grade
teste1_9<-t.test(holl_R ~ SEXO, data = dt_hol_final_9)
#cohensD(holl_R ~ SEXO, data = dt_hol_final_9) # 0.598696
teste2_9<-t.test(holl_I ~ SEXO, data = dt_hol_final_9)
#cohensD(holl_I ~ SEXO, data = dt_hol_final_9) # 0.205519
teste3_9<-t.test(holl_A ~ SEXO, data = dt_hol_final_9)
#cohensD(holl_A ~ SEXO, data = dt_hol_final_9) # 0.5029531
teste4_9<-t.test(holl_S ~ SEXO, data = dt_hol_final_9)
#cohensD(holl_S ~ SEXO, data = dt_hol_final_9) # 0.3737202
teste5_9<-t.test(holl_E ~ SEXO, data = dt_hol_final_9)
#cohensD(holl_E ~ SEXO, data = dt_hol_final_9) # 0.05920547
teste6_9<-t.test(holl_C ~ SEXO, data = dt_hol_final_9)
#cohensD(holl_C ~ SEXO, data = dt_hol_final_9) # 0.006522865

d_cohen_9<-c(0.60,0.20,0.50,0.37,0.06,0.006)

teste_name_9 <- c("Realistic", "Investigative", "Artistic", "Social", "Enterprising", "Conventional")

tab_holl_9 <- map_df(list(teste1_9,teste2_9,teste3_9,teste4_9,teste5_9,teste6_9), tidy)
tab_holl_9 <- tab_holl_9 %>% 
  dplyr::select(-method, -alternative)

tab_holl_9 <- round(tab_holl_9,3)
tab_holl_9$name <- teste_name_9
tab_holl_9$cohen_d<-d_cohen_9

tab_holl_9 <- tab_holl_9[, c(9,1,2,3,10,4,5,6,7,8)]
tab_holl_9$school_year <- "9th grade"

# 12th grade
teste1_11<-t.test(holl_R ~ SEXO, data = dt_hol_final_11)
#cohensD(holl_R ~ SEXO, data = dt_hol_final_11) # 0.881693
teste2_11<-t.test(holl_I ~ SEXO, data = dt_hol_final_11)
#cohensD(holl_I ~ SEXO, data = dt_hol_final_11) # 0.03297314
teste3_11<-t.test(holl_A ~ SEXO, data = dt_hol_final_11)
#cohensD(holl_A ~ SEXO, data = dt_hol_final_11) # 0.3484138
teste4_11<-t.test(holl_S ~ SEXO, data = dt_hol_final_11)
#cohensD(holl_S ~ SEXO, data = dt_hol_final_11) # 0.4834565
teste5_11<-t.test(holl_E ~ SEXO, data = dt_hol_final_11)
#cohensD(holl_E ~ SEXO, data = dt_hol_final_11) # 0.1171847
teste6_11<-t.test(holl_C ~ SEXO, data = dt_hol_final_11)
#cohensD(holl_C ~ SEXO, data = dt_hol_final_11) # 0.03701519

d_cohen_11<-c(0.88,0.03,0.35,0.48,0.12,0.04)

teste_name_11 <- c("Realistic", "Investigative", "Artistic", "Social", "Enterprising", "Conventional")

tab_holl_11 <- map_df(list(teste1_11,teste2_11,teste3_11,teste4_11,teste5_11,teste6_11), tidy)
tab_holl_11 <- tab_holl_11 %>% 
  dplyr::select(-method, -alternative)

tab_holl_11 <- round(tab_holl_11,3)
tab_holl_11$name <- teste_name_11
tab_holl_11$cohen_d<-d_cohen_11

tab_holl_11 <- tab_holl_11[, c(9,1,2,3,10,4,5,6,7,8)]
tab_holl_11$school_year <- "3rd year High School"

tab_holl_years <- rbind(tab_holl_5, tab_holl_9, tab_holl_11)
tab_holl_years <- tab_holl_years[, c(11, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10)]

DT::datatable(tab_holl_years)


```

</br>

### RIASEC gender comparison in boxplots across school years 

</br>

```{r echo=FALSE, message=FALSE, warning=FALSE, fig.show="hold", out.width="50%"}
ggplot(dt_hol_final, aes(x=serie_ano, y=holl_R, fill=SEXO)) + 
  geom_boxplot()+
  labs(title="Realist type",x="Gender", y = "Realistic score") +
  theme_minimal() +
  scale_fill_brewer(palette="RdBu")

ggplot(dt_hol_final, aes(x=serie_ano, y=holl_I, fill=SEXO)) + 
  geom_boxplot()+
  labs(title="Investigative type",x="Gender", y = "Investigative score") +
  theme_minimal() +
  scale_fill_brewer(palette="RdBu")
```

```{r echo=FALSE, message=FALSE, warning=FALSE,  fig.show="hold", out.width="50%"}
ggplot(dt_hol_final, aes(x=serie_ano, y=holl_A, fill=SEXO)) + 
  geom_boxplot()+
  labs(title="Artistic type",x="Gender", y = "Artistic score") +
  theme_minimal() +
  scale_fill_brewer(palette="RdBu")

ggplot(dt_hol_final, aes(x=serie_ano, y=holl_S, fill=SEXO)) + 
  geom_boxplot()+
  labs(title="Social type",x="Gender", y = "Social score") +
  theme_minimal() +
  scale_fill_brewer(palette="RdBu")
```

```{r echo=FALSE, message=FALSE, warning=FALSE, fig.show="hold", out.width="50%"}
ggplot(dt_hol_final, aes(x=serie_ano, y=holl_E, fill=SEXO)) + 
  geom_boxplot()+
  labs(title="Enterprising type",x="Gender", y = "Enterprising score") +
  theme_minimal() +
  scale_fill_brewer(palette="RdBu")

ggplot(dt_hol_final, aes(x=serie_ano, y=holl_C, fill=SEXO)) + 
  geom_boxplot()+
  labs(title="Conventional type",x="Gender", y = "Conventional score") +
  theme_minimal() +
  scale_fill_brewer(palette="RdBu")
```

</br>

## RIASEC secondary constructs scores across gender
- Gender comparison was performed at the domain level.
- Welch's t-test
</br>
- Comparisons were performed in the following order: F-M
- Estimate 1 represents girls' mean score 
- Estimate 2 represents boys' mean score

**Key results:** Girls have a more differentiated profile than boys (d = 0.24). The elevation profile showed significant differences but the effect size was small.

```{r echo=FALSE, warning=FALSE, error=FALSE}
teste1_diff<-t.test(holland_Difer7 ~ SEXO, data = dt_hol_final)
#cohensD(holland_Difer7 ~ SEXO, data = dt_hol_final) # 0.2422724
teste2_elev<-t.test(holland_Elev ~ SEXO, data = dt_hol_final)
#cohensD(holland_Elev ~ SEXO, data = dt_hol_final) # 0.073

d_cohen_sec<-c(0.24,0.07)

teste_name_sec <- c("Diff_7", "Elev")

tab_holl_sec <- map_df(list(teste1_diff,teste2_elev), tidy)
tab_holl_sec <- tab_holl_sec %>% 
  dplyr::select(-method, -alternative)

tab_holl_sec <- round(tab_holl_sec,3)
tab_holl_sec$name <- teste_name_sec
tab_holl_sec$cohen_d<-d_cohen_sec

tab_holl_sec <- tab_holl_sec[, c(9,1,2,3,10,4,5,6,7,8)]

formattable(tab_holl_sec)

```

</br>

### Diff and Elev gender comparison in boxplots 

</br>
```{r echo=FALSE, message=FALSE, warning=FALSE, fig.show="hold", out.width="50%"}

ggplot(dt_hol_final, aes(x=SEXO, y=holland_Difer7, fill=SEXO)) + 
  geom_boxplot()+
  labs(title="Diff score",x="Gender", y = "Diff score") +
  theme_minimal() +
  scale_fill_brewer(palette="RdBu")

ggplot(dt_hol_final, aes(x=SEXO, y=holland_Elev, fill=SEXO)) + 
  geom_boxplot()+
  labs(title="Elev score",x="Gender", y = "Elev score") +
  theme_minimal() +
  scale_fill_brewer(palette="RdBu")
```

</br>
 
## RIASEC secondary constructs scores across gender and school years
- Gender comparison was performed at the domain level.
- Welch's t-test
</br>
- Comparisons were performed in the following order *within school year*: F-M
- Estimate 1 represents girls' mean score 
- Estimate 2 represents boys' mean score

**Key results:** Boys and girls have signifcant differences in Dif over time; however, both boys and girls' profiles tend to be more differentiated over time. Elevation profile showed a small effect size in 5th grade and girls reported a more elevated profile for interests at this grades. Across time, the difference disappear and effect sizes become smaller.

```{r echo=FALSE, warning=FALSE, error=FALSE}
#  5th grade
teste1_diff_5<-t.test(holland_Difer7 ~ SEXO, data = dt_hol_final_5)
#cohensD(holland_Difer7 ~ SEXO, data = dt_hol_final_5) # 0.1475862
teste2_elev_5<-t.test(holland_Elev ~ SEXO, data = dt_hol_final_5)
#cohensD(holland_Elev ~ SEXO, data = dt_hol_final_5) # 0.1500663

d_cohen_sec_5<-c(0.15,0.15)

teste_name_sec_5 <- c("Diff_7", "Elev")

tab_holl_sec_5 <- map_df(list(teste1_diff_5,teste2_elev_5), tidy)
tab_holl_sec_5 <- tab_holl_sec_5 %>% 
  dplyr::select(-method, -alternative)

tab_holl_sec_5 <- round(tab_holl_sec_5,3)
tab_holl_sec_5$name <- teste_name_sec_5
tab_holl_sec_5$cohen_d<-d_cohen_sec_5

tab_holl_sec_5 <- tab_holl_sec_5[, c(9,1,2,3,10,4,5,6,7,8)]
tab_holl_sec_5$school_year <- "5th grade"

#  9th grade
teste1_diff_9<-t.test(holland_Difer7 ~ SEXO, data = dt_hol_final_9)
#cohensD(holland_Difer7 ~ SEXO, data = dt_hol_final_9) # 0.2224102
teste2_elev_9<-t.test(holland_Elev ~ SEXO, data = dt_hol_final_9)
#cohensD(holland_Elev ~ SEXO, data = dt_hol_final_9) # 0.1097756

d_cohen_sec_9<-c(0.22,0.11)

teste_name_sec_9 <- c("Diff_7", "Elev")

tab_holl_sec_9 <- map_df(list(teste1_diff_9,teste2_elev_9), tidy)
tab_holl_sec_9 <- tab_holl_sec_9 %>% 
  dplyr::select(-method, -alternative)

tab_holl_sec_9 <- round(tab_holl_sec_9,3)
tab_holl_sec_9$name <- teste_name_sec_9
tab_holl_sec_9$cohen_d<-d_cohen_sec_9

tab_holl_sec_9 <- tab_holl_sec_9[, c(9,1,2,3,10,4,5,6,7,8)]
tab_holl_sec_9$school_year <- "9th grade"

#  12th grade
teste1_diff_11<-t.test(holland_Difer7 ~ SEXO, data = dt_hol_final_11)
#cohensD(holland_Difer7 ~ SEXO, data = dt_hol_final_11) # 0.341822
teste2_elev_11<-t.test(holland_Elev ~ SEXO, data = dt_hol_final_11)
#cohensD(holland_Elev ~ SEXO, data = dt_hol_final_11) # 0.04378867

d_cohen_sec_11<-c(0.34,0.04)

teste_name_sec_11 <- c("Diff_7", "Elev")

tab_holl_sec_11 <- map_df(list(teste1_diff_11,teste2_elev_11), tidy)
tab_holl_sec_11 <- tab_holl_sec_11 %>% 
  dplyr::select(-method, -alternative)

tab_holl_sec_11 <- round(tab_holl_sec_11,3)
tab_holl_sec_11$name <- teste_name_sec_11
tab_holl_sec_11$cohen_d<-d_cohen_sec_11

tab_holl_sec_11 <- tab_holl_sec_11[, c(9,1,2,3,10,4,5,6,7,8)]
tab_holl_sec_11$school_year <- "3rd year High School"

tab_holl_sec_years <- rbind(tab_holl_sec_5, tab_holl_sec_9, tab_holl_sec_11)
tab_holl_sec_years <- tab_holl_sec_years[, c(11, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10)]

DT::datatable(tab_holl_sec_years)

```

### RIASEC gender comparison in boxplots across school years 

</br>
```{r echo=FALSE, message=FALSE, warning=FALSE, fig.show="hold", out.width="50%"}
ggplot(dt_hol_final, aes(x=serie_ano, y=holland_Difer7, fill=SEXO)) + 
  geom_boxplot()+
  labs(title="Diff score",x="Gender", y = "Diff score") +
  theme_minimal() +
  scale_fill_brewer(palette="RdBu")

ggplot(dt_hol_final, aes(x=serie_ano, y=holland_Elev, fill=SEXO)) + 
  geom_boxplot()+
  labs(title="Elev score",x="Gender", y = "Elev score") +
  theme_minimal() +
  scale_fill_brewer(palette="RdBu")
```

## SENNA by gender
- Gender comparison was performed at the domain level.
- Welch's t-test
</br>
- Comparisons were performed in the following order: F-M
- Estimate 1 represents girls' mean score 
- Estimate 2 represents boys' mean score

- *Key results:* Moderate effects sizes are found for boys and girls differences in O and N. Girls perceived themselves as less developed in N and more developed in O.
```{r echo=FALSE, warning=FALSE, error=FALSE}
teste1_senna<-t.test(O ~ SEXO, data = dt_hol_final)
#cohensD(O ~ SEXO, data = dt_hol_final) # 0.2350143
teste2_senna<-t.test(C ~ SEXO, data = dt_hol_final)
#cohensD(C ~ SEXO, data = dt_hol_final) # 0.1195447
teste3_senna<-t.test(E ~ SEXO, data = dt_hol_final)
#cohensD(E ~ SEXO, data = dt_hol_final) # 0.08817781
teste4_senna<-t.test(A ~ SEXO, data = dt_hol_final)
#cohensD(A ~ SEXO, data = dt_hol_final) # 0.1036554
teste5_senna<-t.test(N ~ SEXO, data = dt_hol_final)
#cohensD(N ~ SEXO, data = dt_hol_final) # 0.6008486

d_cohen_senna<-c(0.23,0.12,0.09,0.10,0.60)

teste_name_senna <- c("O", "C", "E", "A", "N")

tab_holl_senna <- map_df(list(teste1_senna,teste2_senna,teste3_senna,teste4_senna,teste5_senna), tidy)
tab_holl_senna <- tab_holl_senna %>% 
  dplyr::select(-method, -alternative)

tab_holl_senna <- round(tab_holl_senna,3)
tab_holl_senna$name <- teste_name_senna
tab_holl_senna$cohen_d<-d_cohen_senna

tab_holl_senna <- tab_holl_senna[, c(9,1,2,3,10,4,5,6,7,8)]

formattable(tab_holl_senna)

```

</br>

### SENNA gender comparison in boxplots 

</br>

```{r echo=FALSE, message=FALSE, warning=FALSE, fig.show="hold", out.width="50%"}
ggplot(dt_hol_final, aes(x=SEXO, y=O, fill=SEXO)) + 
  geom_boxplot()+
  labs(title="O",x="Gender", y = "O") +
  theme_minimal() +
  scale_fill_brewer(palette="RdBu")

ggplot(dt_hol_final, aes(x=SEXO, y=C, fill=SEXO)) + 
  geom_boxplot()+
  labs(title="C",x="Gender", y = "C") +
  theme_minimal() +
  scale_fill_brewer(palette="RdBu")
```

```{r echo=FALSE, message=FALSE, warning=FALSE, fig.show="hold", out.width="50%"}
ggplot(dt_hol_final, aes(x=SEXO, y=E, fill=SEXO)) + 
  geom_boxplot()+
  labs(title="E",x="Gender", y = "E") +
  theme_minimal() +
  scale_fill_brewer(palette="RdBu")

ggplot(dt_hol_final, aes(x=SEXO, y=A, fill=SEXO)) + 
  geom_boxplot()+
  labs(title="A",x="Gender", y = "A") +
  theme_minimal() +
  scale_fill_brewer(palette="RdBu")
```

```{r echo=FALSE, message=FALSE, warning=FALSE, fig.show="hold", out.width="50%"}
ggplot(dt_hol_final, aes(x=SEXO, y=N, fill=SEXO)) + 
  geom_boxplot()+
  labs(title="N",x="Gender", y = "N") +
  theme_minimal() +
  scale_fill_brewer(palette="RdBu")

```

</br>

## SENNA by gender and across school years

</br>
- Gender comparison was performed at the domain level.
- Welch's t-test
- Comparisons were performed in the following order *within school year*: F-M
- Estimate 1 represents girls' mean score 
- Estimate 2 represents boys' mean score

**Key results:**  Girls reported higher levels of A across time and boys presented a quadratic relationship. Effects sizes were small. Both boys and girls reported less C from 5th to 9th grade and then an increase from 9th grade to 3rd year. Girls reported more C than boys in the 3rd year (small effect size). Overall, girls reported less E than boys but differences had a very small effect size. Both boys and girls reported less E from 5th to 9th grade and then an increase from 9th grade to 3rd year. Girls report less Emotional resilience consistently over time with strong effect sizes. Girls report more O over time with small to medium effect sizes. Both boys and girls reported less O from 5th to 9th grade and then an increase from 9th grade to 3rd year. Girls reported more C than boys in the 3rd year.

```{r echo=FALSE, warning=FALSE, error=FALSE}
#5th grade
teste1_senna_5<-t.test(O ~ SEXO, data = dt_hol_final_5)
#cohensD(O ~ SEXO, data = dt_hol_final_5) #0.1763022
teste2_senna_5<-t.test(C ~ SEXO, data = dt_hol_final_5)
#cohensD(C ~ SEXO, data = dt_hol_final_5) # 0.0841811
teste3_senna_5<-t.test(E ~ SEXO, data = dt_hol_final_5)
#cohensD(E ~ SEXO, data = dt_hol_final_5) # 0.09348467
teste4_senna_5<-t.test(A ~ SEXO, data = dt_hol_final_5)
#cohensD(A ~ SEXO, data = dt_hol_final_5) # 0.09973115
teste5_senna_5<-t.test(N ~ SEXO, data = dt_hol_final_5)
#cohensD(N ~ SEXO, data = dt_hol_final_5) # 0.3736255

d_cohen_senna_5<-c(0.18,0.08,0.09,0.10,0.37)

teste_name_senna_5 <- c("O", "C", "E", "A", "N")

tab_holl_senna_5 <- map_df(list(teste1_senna_5,teste2_senna_5,teste3_senna_5,teste4_senna_5,teste5_senna_5), tidy)
tab_holl_senna_5 <- tab_holl_senna_5 %>% 
  dplyr::select(-method, -alternative)

tab_holl_senna_5 <- round(tab_holl_senna_5,3)
tab_holl_senna_5$name <- teste_name_senna_5
tab_holl_senna_5$cohen_d<-d_cohen_senna_5

tab_holl_senna_5 <- tab_holl_senna_5[, c(9,1,2,3,10,4,5,6,7,8)]
tab_holl_senna_5$school_year <- "5th grade"

#9th grade
teste1_senna_9<-t.test(O ~ SEXO, data = dt_hol_final_9)
#cohensD(O ~ SEXO, data = dt_hol_final_9) #0.3301729
teste2_senna_9<-t.test(C ~ SEXO, data = dt_hol_final_9)
#cohensD(C ~ SEXO, data = dt_hol_final_9) # 0.08333587
teste3_senna_9<-t.test(E ~ SEXO, data = dt_hol_final_9)
#cohensD(E ~ SEXO, data = dt_hol_final_9) # 0.104799
teste4_senna_9<-t.test(A ~ SEXO, data = dt_hol_final_9)
#cohensD(A ~ SEXO, data = dt_hol_final_9) # 0.08779931
teste5_senna_9<-t.test(N ~ SEXO, data = dt_hol_final_9)
#cohensD(N ~ SEXO, data = dt_hol_final_9) # 0.7083029

d_cohen_senna_9<-c(0.33,0.08,0.11,0.09,0.71)

teste_name_senna_9 <- c("O", "C", "E", "A", "N")

tab_holl_senna_9 <- map_df(list(teste1_senna_9,teste2_senna_9,teste3_senna_9,teste4_senna_9,teste5_senna_9), tidy)
tab_holl_senna_9 <- tab_holl_senna_9 %>% 
  dplyr::select(-method, -alternative)

tab_holl_senna_9 <- round(tab_holl_senna_9,3)
tab_holl_senna_9$name <- teste_name_senna_9
tab_holl_senna_9$cohen_d<-d_cohen_senna_9

tab_holl_senna_9 <- tab_holl_senna_9[, c(9,1,2,3,10,4,5,6,7,8)]
tab_holl_senna_9$school_year <- "9th grade"

#12th grade
teste1_senna_11<-t.test(O ~ SEXO, data = dt_hol_final_11)
#cohensD(O ~ SEXO, data = dt_hol_final_11) #0.1828036
teste2_senna_11<-t.test(C ~ SEXO, data = dt_hol_final_11)
#cohensD(C ~ SEXO, data = dt_hol_final_11) # 0.1941264
teste3_senna_11<-t.test(E ~ SEXO, data = dt_hol_final_11)
#cohensD(E ~ SEXO, data = dt_hol_final_11) # 0.06542558
teste4_senna_11<-t.test(A ~ SEXO, data = dt_hol_final_11)
#cohensD(A ~ SEXO, data = dt_hol_final_11) # 0.1271203
teste5_senna_11<-t.test(N ~ SEXO, data = dt_hol_final_11)
#cohensD(N ~ SEXO, data = dt_hol_final_11) # 0.6558839

d_cohen_senna_11<-c(0.18,0.19,0.06,0.13,0.66)

teste_name_senna_11 <- c("O", "C", "E", "A", "N")

tab_holl_senna_11 <- map_df(list(teste1_senna_11,teste2_senna_11,teste3_senna_11,teste4_senna_11,teste5_senna_11), tidy)
tab_holl_senna_11 <- tab_holl_senna_11 %>% 
  dplyr::select(-method, -alternative)

tab_holl_senna_11 <- round(tab_holl_senna_11,3)
tab_holl_senna_11$name <- teste_name_senna_11
tab_holl_senna_11$cohen_d<-d_cohen_senna_11

tab_holl_senna_11 <- tab_holl_senna_11[, c(9,1,2,3,10,4,5,6,7,8)]
tab_holl_senna_11$school_year <- "3rd year High School"

tab_holl_senna_years <- rbind(tab_holl_senna_5, tab_holl_senna_9, tab_holl_senna_11)
tab_holl_senna_years <- tab_holl_senna_years[, c(11, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10)]

DT::datatable(tab_holl_senna_years)

```

</br>

### SENNA gender comparison in boxplots across school years 

</br>

```{r echo=FALSE, message=FALSE, warning=FALSE, fig.show="hold", out.width="50%"}
ggplot(dt_hol_final, aes(x=serie_ano, y=O, fill=SEXO)) + 
  geom_boxplot()+
  labs(title="O",x="Gender", y = "O") +
  theme_minimal() +
  scale_fill_brewer(palette="RdBu")

ggplot(dt_hol_final, aes(x=serie_ano, y=C, fill=SEXO)) + 
  geom_boxplot()+
  labs(title="C",x="Gender", y = "C") +
  theme_minimal() +
  scale_fill_brewer(palette="RdBu")
```

```{r echo=FALSE, message=FALSE, warning=FALSE, fig.show="hold", out.width="50%"}
ggplot(dt_hol_final, aes(x=serie_ano, y=E, fill=SEXO)) + 
  geom_boxplot()+
  labs(title="E",x="Gender", y = "E") +
  theme_minimal() +
  scale_fill_brewer(palette="RdBu")

ggplot(dt_hol_final, aes(x=serie_ano, y=A, fill=SEXO)) + 
  geom_boxplot()+
  labs(title="A",x="Gender", y = "A") +
  theme_minimal() +
  scale_fill_brewer(palette="RdBu")
```

```{r echo=FALSE, message=FALSE, warning=FALSE, fig.show="hold", out.width="50%"}
ggplot(dt_hol_final, aes(x=serie_ano, y=N, fill=SEXO)) + 
  geom_boxplot()+
  labs(title="N",x="Gender", y = "N") +
  theme_minimal() +
  scale_fill_brewer(palette="RdBu")

```

# RIASEC and Senna correlation matrix 

# RIASEC, Secondary constructs and Senna - Overall
* Domain level
* Pearson correlations
* N ~ 101724 for Senna and other questionnaires

**Key results:** RIASEC correlations follow a quasi-circumplex pattern (i.e. wave) Differentiation correlated more strongly with C and O. Elevation correlated more strongly with C, E and O. About RIASEC: R correlated negatively with Dif7 and S correlated positively and moderately with Dif7. All interests were correlated with Elevation.

```{r echo=FALSE, warning=FALSE, message=FALSE, fig.align="center"}

senna_riasec_names <- c("A", "C", "E", "N", "O",
                        "holl_R", "holl_I", "holl_A", "holl_S", "holl_E", "holl_C",
                        "holland_Difer7", "holland_Elev"
                        )

# senna_riasec_names_2 <- c("A", "C", "E", "N", "O",
#                         "holl_R", "holl_I", "holl_A", "holl_S", "holl_E", "holl_C"
#                         )
# 
# diff_names <- c("holland_Difer7", "holland_Elev"
#                         )
# 
# corr.test(dt_hol_final[,senna_riasec_names_2], y = dt_hol_final[,diff_names], use = "pairwise")

#compute corrplot
senna_riasec_cor <- cor(dt_hol_final[,senna_riasec_names], 
                             use="pairwise.complete.obs"
                        )

corrplot(senna_riasec_cor, method="color", 
         number.cex = 0.7, 
         addCoef.col = "black", # Add coefficient of correlation
         tl.col="black", tl.srt=45,
         diag=TRUE)

```

# RIASEC, Secondary constructs and Senna - 5th grade
* Domain level
* Pearson correlations
* N ~ 26819

```{r echo=FALSE, warning=FALSE, message=FALSE, fig.align="center"}

senna_riasec_names <- c("A",   "C", "E", "N", "O",
                        "holl_R", "holl_I", "holl_A", "holl_S", "holl_E", "holl_C",
                        "holland_Difer7", "holland_Elev"
                        )

# senna_riasec_names_2 <- c("A", "C", "E", "N", "O",
#                         "holl_R", "holl_I", "holl_A", "holl_S", "holl_E", "holl_C"
#                         )
# 
# diff_names <- c("holland_Difer7", "holland_Elev"
#                         )
# 
# corr.test(dt_hol_final_5[,senna_riasec_names_2], y = dt_hol_final_5[,diff_names], use = "pairwise")


#compute corrplot
senna_riasec_cor_5 <- cor(dt_hol_final_5[,senna_riasec_names], 
                             use="pairwise.complete.obs"
                        )

corrplot(senna_riasec_cor_5, method="color", 
         number.cex = 0.7, 
         addCoef.col = "black", # Add coefficient of correlation
         tl.col="black", tl.srt=45,
         diag=TRUE)

```

# RIASEC, Secondary constructs and Senna - 9th grade
* Domain level
* Pearson correlations
* N ~ 40186

```{r echo=FALSE, warning=FALSE, message=FALSE, fig.align="center"}

senna_riasec_names <- c("A",   "C", "E", "N", "O",
                        "holl_R", "holl_I", "holl_A", "holl_S", "holl_E", "holl_C",
                        "holland_Difer7", "holland_Elev"
                        )

# senna_riasec_names_2 <- c("A", "C", "E", "N", "O",
#                         "holl_R", "holl_I", "holl_A", "holl_S", "holl_E", "holl_C"
#                         )
# 
# diff_names <- c("holland_Difer7", "holland_Elev"
#                         )
# 
# corr.test(dt_hol_final_9[,senna_riasec_names_2], y = dt_hol_final_9[,diff_names], use = "pairwise")


#compute corrplot
senna_riasec_cor_9 <- cor(dt_hol_final_9[,senna_riasec_names], 
                             use="pairwise.complete.obs"
                        )

corrplot(senna_riasec_cor_9, method="color", 
         number.cex = 0.7, 
         addCoef.col = "black", # Add coefficient of correlation
         tl.col="black", tl.srt=45,
         diag=TRUE)

```

# RIASEC, Secondary constructs and Senna - 3rd year High School
* Domain level
* Pearson correlations
* N ~ 34719

```{r echo=FALSE, warning=FALSE, message=FALSE, fig.align="center"}

senna_riasec_names <- c("A",   "C", "E", "N", "O",
                        "holl_R", "holl_I", "holl_A", "holl_S", "holl_E", "holl_C",
                        "holland_Difer7", "holland_Elev"
                        )

# senna_riasec_names_2 <- c("A", "C", "E", "N", "O",
#                         "holl_R", "holl_I", "holl_A", "holl_S", "holl_E", "holl_C"
#                         )
# 
# diff_names <- c("holland_Difer7", "holland_Elev"
#                         )
# 
# corr.test(dt_hol_final_11[,senna_riasec_names_2], y = dt_hol_final_11[,diff_names], use = "pairwise")

#compute corrplot
senna_riasec_cor_11 <- cor(dt_hol_final_11[,senna_riasec_names], 
                             use="pairwise.complete.obs"
                        )

corrplot(senna_riasec_cor_11, method="color", 
         number.cex = 0.7, 
         addCoef.col = "black", # Add coefficient of correlation
         tl.col="black", tl.srt=45,
         diag=TRUE)

```

</br> 

# Regression analyses

## Is differentiation (Dif7) predicted by SEMS when controlling for gender and school year?
- Model: holland_Difer7 ~ O + C + E + A + N + SEXO + serie_ano
- All variables were significant predictors. Globally, they explained *11.2%* of differentiation levels.
- N = 101.541 students

**Key results:** Overall, differentiation levels were lower for boys than girls. And, as students grew up, their differentiation levels increased, especially in the 3rd of High School. All SEMS predicted differentiation levels: O, C and E were the strongest predictors. Emotional resilience was negatively associated with differentiation.


```{r echo=FALSE}
# Dif7 varia entre 0 e 2, com média de 0.75
fit_dif7_cse <-lm(holland_Difer7 ~ O + C + E + A + N + SEXO + serie_ano, data = dt_hol_final)

tab_model(fit_dif7_cse, show.std = TRUE, show.se=TRUE)
```

### What is the kind of relationship between dif7 and Senna?

**Key results:** The relationship between O, C, E and A is linear; thus, students with a more differentiated interest profile tend to perceive themselves as more developed in these SEMS domains. However, the same cannot be said to N, which seems to have a quadratic relationship with differentiation. The relationship between N and differentiation seems to decrease from low to emergent level until it comes back at the capable level and increases in the very capable level.
```{r echo = FALSE, include = FALSE}

table_domains_diff_O <- dt_hol_final %>% 
  group_by(O_cat) %>% 
  dplyr::summarize(
    dif_mean = mean(holland_Difer7, na.rm=TRUE)
  ) %>% 
  pivot_longer(
    cols = "O_cat",
    names_to = "domain",
    values_to = c("nivel")
  )

table_domains_diff_C <- dt_hol_final %>% 
  group_by(C_cat) %>% 
  dplyr::summarize(
    dif_mean = mean(holland_Difer7, na.rm=TRUE)
  ) %>% 
  pivot_longer(
    cols = "C_cat",
    names_to = "domain",
    values_to = c("nivel")
  )

table_domains_diff_E <- dt_hol_final %>% 
  group_by(E_cat) %>% 
  dplyr::summarize(
    dif_mean = mean(holland_Difer7, na.rm=TRUE)
  ) %>% 
  pivot_longer(
    cols = "E_cat",
    names_to = "domain",
    values_to = c("nivel")
  )

table_domains_diff_A <- dt_hol_final %>% 
  group_by(A_cat) %>% 
  dplyr::summarize(
    dif_mean = mean(holland_Difer7, na.rm=TRUE)
  ) %>% 
  pivot_longer(
    cols = "A_cat",
    names_to = "domain",
    values_to = c("nivel")
  )

table_domains_diff_N <- dt_hol_final %>% 
  group_by(N_cat) %>% 
  dplyr::summarize(
    dif_mean = mean(holland_Difer7, na.rm=TRUE)
  ) %>% 
  pivot_longer(
    cols = "N_cat",
    names_to = "domain",
    values_to = c("nivel")
  )

table_dif <- rbind(table_domains_diff_O, 
                   table_domains_diff_C, 
                   table_domains_diff_E,
                   table_domains_diff_A,
                   table_domains_diff_N)

table_dif$nivel <- as.factor(table_dif$nivel)

table_dif$nivel  <-  recode(
  table_dif$nivel,
  'baixo' = "Low",
  'emerg' = "Emergent",
  'capaz' = "Capable",
  'muit/cpz' = "Very \ncapable"
)

table_dif$domain <-  recode(table_dif$domain,
                                     'O_cat' = "O_Openness",
                                     'C_cat' = "C_Self_management",
                                     'E_cat' = "E_Engagement_w_others",
                                     'A_cat' = "A_Amity",
                                     'N_cat' = "N_Emotional_resilience",
                            
                            )

# table_dif$nivel  <-  recode(
#   table_dif$nivel,
#   'Pouco desenvolvido' = "Pouco \ndesenvolvido",
#   'Medianamente desenvolvido' = "Medianamente \ndesenvolvido",
#   'Bastante desenvolvido' = "Bastante \ndesenvolvido",
#   'Muito desenvolvido' = "Muito \ndesenvolvido"
# )

# table_dif$domain <-  recode(table_dif$domain,
#                                      'LDep_cat' = "Autoconfiança",
#                                      'Tru_cat' = "Confiança",
#                                      'Soc_cat' = "Iniciativa Social")
```

```{r echo = FALSE}
table_dif %>%
  mutate(
    nivel = 
    fct_relevel(nivel, "Low", 
                "Emergent", 
                "Capable", 
                "Very \ncapable"))%>% 
  drop_na() %>% 
  ggplot(aes(x = nivel, y =  dif_mean, fill=domain)) + 
  geom_bar(
    stat = "identity",
    position = position_dodge(width = 0.9)) +
  geom_text(aes(label=round(dif_mean,2)), 
            position=position_dodge(width=0.9), 
            size = 3,
            vjust=-0.5,
            fontface = "bold") +
  scale_fill_manual(values=c("#00A8E9","#FFDE55","#00528F", "#002371", "#FFCD00")) +
  ylim(0,2) +
  theme_hc() +
  theme(axis.title.x=element_blank(),
      axis.title.y=element_blank(),
      axis.text.x = element_text(color = "black", size = 10, face = "bold"),
      axis.text.y = element_text(color = "black", size = 15, face = "bold"),
      legend.title = element_blank()
  )


# ggsave("Gráfico Ebook - Pertencimento - Opção 1.png", height = 7, width = 10, dpi = 300)
```

### What is the kind of relationship between differentiation and Senna by gender?

```{r echo = FALSE, include = FALSE}
# F
table_domains_dif_O_f <- dt_hol_final %>% 
  filter(SEXO == "F") %>% 
  group_by(O_cat) %>% 
  dplyr::summarize(
    dif_mean = mean(holland_Difer7, na.rm=TRUE)
  ) %>% 
  pivot_longer(
    cols = "O_cat",
    names_to = "domain",
    values_to = c("nivel")
  )

table_domains_dif_C_f <- dt_hol_final %>%  
  filter(SEXO == "F") %>% 
  group_by(C_cat) %>% 
  dplyr::summarize(
    dif_mean = mean(holland_Difer7, na.rm=TRUE)
  ) %>% 
  pivot_longer(
    cols = "C_cat",
    names_to = "domain",
    values_to = c("nivel")
  )

table_domains_dif_E_f <- dt_hol_final %>%  
  filter(SEXO == "F") %>% 
  group_by(E_cat) %>% 
  dplyr::summarize(
    dif_mean = mean(holland_Difer7, na.rm=TRUE)
  ) %>% 
  pivot_longer(
    cols = "E_cat",
    names_to = "domain",
    values_to = c("nivel")
  )

table_domains_dif_A_f <- dt_hol_final %>%  
  filter(SEXO == "F") %>% 
  group_by(A_cat) %>% 
  dplyr::summarize(
    dif_mean = mean(holland_Difer7, na.rm=TRUE)
  ) %>% 
  pivot_longer(
    cols = "A_cat",
    names_to = "domain",
    values_to = c("nivel")
  )

table_domains_dif_N_f <- dt_hol_final %>%  
  filter(SEXO == "F") %>% 
  group_by(N_cat) %>% 
  dplyr::summarize(
    dif_mean = mean(holland_Difer7, na.rm=TRUE)
  ) %>% 
  pivot_longer(
    cols = "N_cat",
    names_to = "domain",
    values_to = c("nivel")
  )

table_dif_f <- rbind(table_domains_dif_O_f, 
                   table_domains_dif_C_f, 
                   table_domains_dif_E_f,
                   table_domains_dif_A_f,
                   table_domains_dif_N_f)

table_dif_f$nivel <- as.factor(table_dif_f$nivel)

table_dif_f$nivel  <-  recode(
  table_dif_f$nivel,
  'baixo' = "Low",
  'emerg' = "Emergent",
  'capaz' = "Capable",
  'muit/cpz' = "Very \ncapable"
)

table_dif_f$domain <-  recode(table_dif_f$domain,
                                     'O_cat' = "O_Openness",
                                     'C_cat' = "C_Self_management",
                                     'E_cat' = "E_Engagement_w_others",
                                     'A_cat' = "A_Amity",
                                     'N_cat' = "N_Emotional_resilience",
                            
                            )

# table_dif$nivel  <-  recode(
#   table_dif$nivel,
#   'Pouco desenvolvido' = "Pouco \ndesenvolvido",
#   'Medianamente desenvolvido' = "Medianamente \ndesenvolvido",
#   'Bastante desenvolvido' = "Bastante \ndesenvolvido",
#   'Muito desenvolvido' = "Muito \ndesenvolvido"
# )

# table_dif$domain <-  recode(table_dif$domain,
#                                      'LDep_cat' = "Autoconfiança",
#                                      'Tru_cat' = "Confiança",
#                                      'Soc_cat' = "Iniciativa Social")

# M
table_domains_dif_O_m <- dt_hol_final %>% 
  filter(SEXO == "M") %>% 
  group_by(O_cat) %>% 
  dplyr::summarize(
    dif_mean = mean(holland_Difer7, na.rm=TRUE)
  ) %>% 
  pivot_longer(
    cols = "O_cat",
    names_to = "domain",
    values_to = c("nivel")
  )

table_domains_dif_C_m <- dt_hol_final %>%  
  filter(SEXO == "M") %>% 
  group_by(C_cat) %>% 
  dplyr::summarize(
    dif_mean = mean(holland_Difer7, na.rm=TRUE)
  ) %>% 
  pivot_longer(
    cols = "C_cat",
    names_to = "domain",
    values_to = c("nivel")
  )

table_domains_dif_E_m <- dt_hol_final %>%  
  filter(SEXO == "M") %>% 
  group_by(E_cat) %>% 
  dplyr::summarize(
    dif_mean = mean(holland_Difer7, na.rm=TRUE)
  ) %>% 
  pivot_longer(
    cols = "E_cat",
    names_to = "domain",
    values_to = c("nivel")
  )

table_domains_dif_A_m <- dt_hol_final %>%  
  filter(SEXO == "M") %>% 
  group_by(A_cat) %>% 
  dplyr::summarize(
    dif_mean = mean(holland_Difer7, na.rm=TRUE)
  ) %>% 
  pivot_longer(
    cols = "A_cat",
    names_to = "domain",
    values_to = c("nivel")
  )

table_domains_dif_N_m <- dt_hol_final %>%  
  filter(SEXO == "M") %>% 
  group_by(N_cat) %>% 
  dplyr::summarize(
    dif_mean = mean(holland_Difer7, na.rm=TRUE)
  ) %>% 
  pivot_longer(
    cols = "N_cat",
    names_to = "domain",
    values_to = c("nivel")
  )

table_dif_m <- rbind(table_domains_dif_O_m, 
                   table_domains_dif_C_m, 
                   table_domains_dif_E_m,
                   table_domains_dif_A_m,
                   table_domains_dif_N_m)

table_dif_m$nivel <- as.factor(table_dif_m$nivel)

table_dif_m$nivel  <-  recode(
  table_dif_m$nivel,
  'baixo' = "Low",
  'emerg' = "Emergent",
  'capaz' = "Capable",
  'muit/cpz' = "Very \ncapable"
)

table_dif_m$domain <-  recode(table_dif_m$domain,
                                     'O_cat' = "O_Openness",
                                     'C_cat' = "C_Self_management",
                                     'E_cat' = "E_Engagement_w_others",
                                     'A_cat' = "A_Amity",
                                     'N_cat' = "N_Emotional_resilience",
                            
                            )

```

*Girls and boys SEMS development according to differentiation*
- The first plot represents girls scores and the second plot represents boys scores.
- As shown in the previous results, girls have greater differentiation scores than boys. For girls, A and O have linear relationships with differentiation. For C and E, the relationship is stable in the low and emergent levels and tend to increase in capable and very capable levels. For N, the relationship decreases from low to emergent and starts to increase again at the capable level. For boys and A, C, E and O, the relationship is stable in the low and emergent levels and tend to increase in capable and very capable levels. For N, the relationship decreases from low to emergent and starts to increase again at the capable level.

```{r echo=FALSE, message=FALSE, warning=FALSE, fig.show="hold", out.width="50%"}
table_dif_f %>%
  mutate(
    nivel = 
    fct_relevel(nivel, "Low", 
                "Emergent", 
                "Capable", 
                "Very \ncapable"))%>% 
  drop_na() %>% 
  ggplot(aes(x = nivel, y =  dif_mean, fill=domain)) + 
  geom_bar(
    stat = "identity",
    position = position_dodge(width = 0.9)) +
  geom_text(aes(label=round(dif_mean,2)), 
            position=position_dodge(width=0.9), 
            size = 3,
            vjust=-0.5,
            fontface = "bold") +
  scale_fill_manual(values=c("#00A8E9","#FFDE55","#00528F", "#002371", "#FFCD00")) +
  ylim(0,2) +
  theme_hc() +
  theme(axis.title.x=element_blank(),
      axis.title.y=element_blank(),
      axis.text.x = element_text(color = "black", size = 10, face = "bold"),
      axis.text.y = element_text(color = "black", size = 15, face = "bold"),
      legend.title = element_blank()
  )

# ggsave("Gráfico Ebook - Pertencimento - Opção 1.png", height = 7, width = 10, dpi = 300)

table_dif_m %>%
  mutate(
    nivel = 
    fct_relevel(nivel, "Low", 
                "Emergent", 
                "Capable", 
                "Very \ncapable"))%>% 
  drop_na() %>% 
  ggplot(aes(x = nivel, y =  dif_mean, fill=domain)) + 
  geom_bar(
    stat = "identity",
    position = position_dodge(width = 0.9)) +
  geom_text(aes(label=round(dif_mean,2)), 
            position=position_dodge(width=0.9), 
            size = 3,
            vjust=-0.5,
            fontface = "bold") +
  scale_fill_manual(values=c("#00A8E9","#FFDE55","#00528F", "#002371", "#FFCD00")) +
  ylim(0,2) +
  theme_hc() +
  theme(axis.title.x=element_blank(),
      axis.title.y=element_blank(),
      axis.text.x = element_text(color = "black", size = 10, face = "bold"),
      axis.text.y = element_text(color = "black", size = 15, face = "bold"),
      legend.title = element_blank()
  )

# ggsave("Gráfico Ebook - Pertencimento - Opção 1.png", height = 7, width = 10, dpi = 300)
```

</br>

## Is elevation (Elev) predicted by SEMS when controlling for gender and school year?
- Model: holland_Elev ~ O + C + E + A + N + SEXO + serie_ano
- All variables were significant predictors. Globally, they explained *14.5%* of differentiation levels.
- N = 101.541 students

**Key results:** Overall, elevation levels were lower for boys than girls. And, as students grew up, their elevation levels increased, but the difference between 9th grade and 3rd of High School was small. All SEMS predicted elevation levels: O was the strongest predictor followed by E and C (standardized estimates), similar to Bullock and Reardon (2008). Amity was negatively associated with elevation.

```{r echo=FALSE}
# Elev
fit_elev_cse <-lm(holland_Elev ~ O + C + E + A + N + SEXO + serie_ano, data = dt_hol_final)

tab_model(fit_elev_cse, show.std = TRUE, show.se=TRUE)
```

### What is the kind of relationship between elevation and Senna?

*Key results:* The relationship between O, C, E, A and N  is linear; thus, students with a more elevated interest profile tend to perceive themselves as more developed in these SEMS domains. 

```{r echo = FALSE, include = FALSE}

table_domains_elev_O <- dt_hol_final %>% 
  group_by(O_cat) %>% 
  dplyr::summarize(
    elev_mean = mean(holland_Elev, na.rm=TRUE)
  ) %>% 
  pivot_longer(
    cols = "O_cat",
    names_to = "domain",
    values_to = c("nivel")
  )

table_domains_elev_C <- dt_hol_final %>% 
  group_by(C_cat) %>% 
  dplyr::summarize(
    elev_mean = mean(holland_Elev, na.rm=TRUE)
  ) %>% 
  pivot_longer(
    cols = "C_cat",
    names_to = "domain",
    values_to = c("nivel")
  )

table_domains_elev_E <- dt_hol_final %>% 
  group_by(E_cat) %>% 
  dplyr::summarize(
    elev_mean = mean(holland_Elev, na.rm=TRUE)
  ) %>% 
  pivot_longer(
    cols = "E_cat",
    names_to = "domain",
    values_to = c("nivel")
  )

table_domains_elev_A <- dt_hol_final %>% 
  group_by(A_cat) %>% 
  dplyr::summarize(
    elev_mean = mean(holland_Elev, na.rm=TRUE)
  ) %>% 
  pivot_longer(
    cols = "A_cat",
    names_to = "domain",
    values_to = c("nivel")
  )

table_domains_elev_N <- dt_hol_final %>% 
  group_by(N_cat) %>% 
  dplyr::summarize(
    elev_mean = mean(holland_Elev, na.rm=TRUE)
  ) %>% 
  pivot_longer(
    cols = "N_cat",
    names_to = "domain",
    values_to = c("nivel")
  )

table_elev <- rbind(table_domains_elev_O, 
                   table_domains_elev_C, 
                   table_domains_elev_E,
                   table_domains_elev_A,
                   table_domains_elev_N)

table_elev$nivel <- as.factor(table_elev$nivel)

table_elev$nivel  <-  recode(
  table_elev$nivel,
  'baixo' = "Low",
  'emerg' = "Emergent",
  'capaz' = "Capable",
  'muit/cpz' = "Very \ncapable"
)

table_elev$domain <-  recode(table_elev$domain,
                                     'O_cat' = "O_Openness",
                                     'C_cat' = "C_Self_management",
                                     'E_cat' = "E_Engagement_w_others",
                                     'A_cat' = "A_Amity",
                                     'N_cat' = "N_Emotional_resilience",
                            
                            )

# table_dif$nivel  <-  recode(
#   table_dif$nivel,
#   'Pouco desenvolvido' = "Pouco \ndesenvolvido",
#   'Medianamente desenvolvido' = "Medianamente \ndesenvolvido",
#   'Bastante desenvolvido' = "Bastante \ndesenvolvido",
#   'Muito desenvolvido' = "Muito \ndesenvolvido"
# )

# table_dif$domain <-  recode(table_dif$domain,
#                                      'LDep_cat' = "Autoconfiança",
#                                      'Tru_cat' = "Confiança",
#                                      'Soc_cat' = "Iniciativa Social")
```

```{r echo = FALSE}
table_elev %>%
  mutate(
    nivel = 
    fct_relevel(nivel, "Low", 
                "Emergent", 
                "Capable", 
                "Very \ncapable"))%>% 
  drop_na() %>% 
  ggplot(aes(x = nivel, y =  elev_mean, fill=domain)) + 
  geom_bar(
    stat = "identity",
    position = position_dodge(width = 0.9)) +
  geom_text(aes(label=round(elev_mean,2)), 
            position=position_dodge(width=0.9), 
            size = 3,
            vjust=-0.5,
            fontface = "bold") +
  scale_fill_manual(values=c("#00A8E9","#FFDE55","#00528F", "#002371", "#FFCD00")) +
  ylim(0,4) +
  theme_hc() +
  theme(axis.title.x=element_blank(),
      axis.title.y=element_blank(),
      axis.text.x = element_text(color = "black", size = 10, face = "bold"),
      axis.text.y = element_text(color = "black", size = 15, face = "bold"),
      legend.title = element_blank()
  )

# ggsave("Gráfico Ebook - Pertencimento - Opção 1.png", height = 7, width = 10, dpi = 300)
```

*Girls and boys SEMS development according to elevation*
- The first plot represents girls scores and the second plot represents boys scores.
- Boys and girls have similar elevation scores across domains and have linear relationships for A, C, E and O. For N, there is a slight difference between boys and girls scores across domains in which girls girls presented greater elevation scores than boys for Senna categories in N.

```{r echo = FALSE, include = FALSE}
# F
table_domains_elev_O_f <- dt_hol_final %>% 
  filter(SEXO == "F") %>% 
  group_by(O_cat) %>% 
  dplyr::summarize(
    elev_mean = mean(holland_Elev, na.rm=TRUE)
  ) %>% 
  pivot_longer(
    cols = "O_cat",
    names_to = "domain",
    values_to = c("nivel")
  )

table_domains_elev_C_f <- dt_hol_final %>%  
  filter(SEXO == "F") %>% 
  group_by(C_cat) %>% 
  dplyr::summarize(
    elev_mean = mean(holland_Elev, na.rm=TRUE)
  ) %>% 
  pivot_longer(
    cols = "C_cat",
    names_to = "domain",
    values_to = c("nivel")
  )

table_domains_elev_E_f <- dt_hol_final %>%  
  filter(SEXO == "F") %>% 
  group_by(E_cat) %>% 
  dplyr::summarize(
    elev_mean = mean(holland_Elev, na.rm=TRUE)
  ) %>% 
  pivot_longer(
    cols = "E_cat",
    names_to = "domain",
    values_to = c("nivel")
  )

table_domains_elev_A_f <- dt_hol_final %>%  
  filter(SEXO == "F") %>% 
  group_by(A_cat) %>% 
  dplyr::summarize(
    elev_mean = mean(holland_Elev, na.rm=TRUE)
  ) %>% 
  pivot_longer(
    cols = "A_cat",
    names_to = "domain",
    values_to = c("nivel")
  )

table_domains_elev_N_f <- dt_hol_final %>%  
  filter(SEXO == "F") %>% 
  group_by(N_cat) %>% 
  dplyr::summarize(
    elev_mean = mean(holland_Elev, na.rm=TRUE)
  ) %>% 
  pivot_longer(
    cols = "N_cat",
    names_to = "domain",
    values_to = c("nivel")
  )

table_elev_f <- rbind(table_domains_elev_O_f, 
                   table_domains_elev_C_f, 
                   table_domains_elev_E_f,
                   table_domains_elev_A_f,
                   table_domains_elev_N_f)

table_elev_f$nivel <- as.factor(table_elev_f$nivel)

table_elev_f$nivel  <-  recode(
  table_elev_f$nivel,
  'baixo' = "Low",
  'emerg' = "Emergent",
  'capaz' = "Capable",
  'muit/cpz' = "Very \ncapable"
)

table_elev_f$domain <-  recode(table_elev_f$domain,
                                     'O_cat' = "O_Openness",
                                     'C_cat' = "C_Self_management",
                                     'E_cat' = "E_Engagement_w_others",
                                     'A_cat' = "A_Amity",
                                     'N_cat' = "N_Emotional_resilience",
                            
                            )

# table_dif$nivel  <-  recode(
#   table_dif$nivel,
#   'Pouco desenvolvido' = "Pouco \ndesenvolvido",
#   'Medianamente desenvolvido' = "Medianamente \ndesenvolvido",
#   'Bastante desenvolvido' = "Bastante \ndesenvolvido",
#   'Muito desenvolvido' = "Muito \ndesenvolvido"
# )

# table_dif$domain <-  recode(table_dif$domain,
#                                      'LDep_cat' = "Autoconfiança",
#                                      'Tru_cat' = "Confiança",
#                                      'Soc_cat' = "Iniciativa Social")

# M
table_domains_elev_O_m <- dt_hol_final %>% 
  filter(SEXO == "M") %>% 
  group_by(O_cat) %>% 
  dplyr::summarize(
    elev_mean = mean(holland_Elev, na.rm=TRUE)
  ) %>% 
  pivot_longer(
    cols = "O_cat",
    names_to = "domain",
    values_to = c("nivel")
  )

table_domains_elev_C_m <- dt_hol_final %>%  
  filter(SEXO == "M") %>% 
  group_by(C_cat) %>% 
  dplyr::summarize(
    elev_mean = mean(holland_Elev, na.rm=TRUE)
  ) %>% 
  pivot_longer(
    cols = "C_cat",
    names_to = "domain",
    values_to = c("nivel")
  )

table_domains_elev_E_m <- dt_hol_final %>%  
  filter(SEXO == "M") %>% 
  group_by(E_cat) %>% 
  dplyr::summarize(
    elev_mean = mean(holland_Elev, na.rm=TRUE)
  ) %>% 
  pivot_longer(
    cols = "E_cat",
    names_to = "domain",
    values_to = c("nivel")
  )

table_domains_elev_A_m <- dt_hol_final %>%  
  filter(SEXO == "M") %>% 
  group_by(A_cat) %>% 
  dplyr::summarize(
    elev_mean = mean(holland_Elev, na.rm=TRUE)
  ) %>% 
  pivot_longer(
    cols = "A_cat",
    names_to = "domain",
    values_to = c("nivel")
  )

table_domains_elev_N_m <- dt_hol_final %>%  
  filter(SEXO == "M") %>% 
  group_by(N_cat) %>% 
  dplyr::summarize(
    elev_mean = mean(holland_Elev, na.rm=TRUE)
  ) %>% 
  pivot_longer(
    cols = "N_cat",
    names_to = "domain",
    values_to = c("nivel")
  )

table_elev_m <- rbind(table_domains_elev_O_m, 
                   table_domains_elev_C_m, 
                   table_domains_elev_E_m,
                   table_domains_elev_A_m,
                   table_domains_elev_N_m)

table_elev_m$nivel <- as.factor(table_elev_m$nivel)

table_elev_m$nivel  <-  recode(
  table_elev_m$nivel,
  'baixo' = "Low",
  'emerg' = "Emergent",
  'capaz' = "Capable",
  'muit/cpz' = "Very \ncapable"
)

table_elev_m$domain <-  recode(table_elev_m$domain,
                                     'O_cat' = "O_Openness",
                                     'C_cat' = "C_Self_management",
                                     'E_cat' = "E_Engagement_w_others",
                                     'A_cat' = "A_Amity",
                                     'N_cat' = "N_Emotional_resilience",
                            
                            )

```

```{r echo=FALSE, message=FALSE, warning=FALSE, fig.show="hold", out.width="50%"}
table_elev_f %>%
  mutate(
    nivel = 
    fct_relevel(nivel, "Low", 
                "Emergent", 
                "Capable", 
                "Very \ncapable"))%>% 
  drop_na() %>% 
  ggplot(aes(x = nivel, y =  elev_mean, fill=domain)) + 
  geom_bar(
    stat = "identity",
    position = position_dodge(width = 0.9)) +
  geom_text(aes(label=round(elev_mean,2)), 
            position=position_dodge(width=0.9), 
            size = 3,
            vjust=-0.5,
            fontface = "bold") +
  scale_fill_manual(values=c("#00A8E9","#FFDE55","#00528F", "#002371", "#FFCD00")) +
  ylim(0,4) +
  theme_hc() +
  theme(axis.title.x=element_blank(),
      axis.title.y=element_blank(),
      axis.text.x = element_text(color = "black", size = 10, face = "bold"),
      axis.text.y = element_text(color = "black", size = 15, face = "bold"),
      legend.title = element_blank()
  )

# ggsave("Gráfico Ebook - Pertencimento - Opção 1.png", height = 7, width = 10, dpi = 300)

table_elev_m %>%
  mutate(
    nivel = 
    fct_relevel(nivel, "Low", 
                "Emergent", 
                "Capable", 
                "Very \ncapable"))%>% 
  drop_na() %>% 
  ggplot(aes(x = nivel, y =  elev_mean, fill=domain)) + 
  geom_bar(
    stat = "identity",
    position = position_dodge(width = 0.9)) +
  geom_text(aes(label=round(elev_mean,2)), 
            position=position_dodge(width=0.9), 
            size = 3,
            vjust=-0.5,
            fontface = "bold") +
  scale_fill_manual(values=c("#00A8E9","#FFDE55","#00528F", "#002371", "#FFCD00")) +
  ylim(0,4) +
  theme_hc() +
  theme(axis.title.x=element_blank(),
      axis.title.y=element_blank(),
      axis.text.x = element_text(color = "black", size = 10, face = "bold"),
      axis.text.y = element_text(color = "black", size = 15, face = "bold"),
      legend.title = element_blank()
  )

# ggsave("Gráfico Ebook - Pertencimento - Opção 1.png", height = 7, width = 10, dpi = 300)
```

# Is Dif7 relationship with SEMS moderated by GENDER?

*Key results:* The relationship for C, E and A is more or less similar for both genders; however, for O and N there is a difference in the estimates. O and E have greater estimates for predicting Diff for girls when compared to boys. N has a negative estimate associated with differentiation for girls. For boys, N is significant although weak effect. School year is a positive estimate for both genders, although stronger for girls. Overall, as students grow up, their interest profile becomes more differentiated. 

```{r echo = FALSE}

model_dif7 <- ' 
           # direct effect
             holland_Difer7 ~ O + C + E + A + N + serie
      '

fit_dif7 <- sem(model_dif7, data = dt_hol_final, group = "SEXO")

lavaan::summary(fit_dif7, fit.measures=T, standardized=T, ci=TRUE)
```

```{r echo = FALSE}
lavaanPlot(model = fit_dif7, 
           node_options = list(shape = "box", 
                                                 fontname = "Helvetica"), 
           edge_options = list(color = "grey"), 
           coefs = TRUE, 
           stand=TRUE)

```

# Is Elev relationship with SEMS moderated by GENDER?
*Key results:* O is the strongest IV for both gender, although the greater estimate belongs to boys. Intercepts are similar for both genders; thus, there are no differences between boys and girls elevation profiles. O is the strongest predictor for both genders and estimates are similar for both genders (diffs < 0.05). A is not a significant predictor for girls' differentiation when school year is added. School year is a stronger predictor for boys than girls.

```{r echo = FALSE}
model_elev <- ' 
           # direct effect
             holland_Elev ~ O + C + E + A + N + serie
      '

fit_elev <- sem(model_elev, data = dt_hol_final, group = "SEXO")

lavaan::summary(fit_elev, fit.measures=T, standardized=T, ci=TRUE)
```

```{r echo = FALSE}
lavaanPlot(model = fit_elev, node_options = list(shape = "box", fontname = "Helvetica"), edge_options = list(color = "grey"), coefs = TRUE, stand=TRUE)

```


# Is Dif7 relationship with SEMS moderated by SCHOOL YEAR?

```{r echo = FALSE}

model_dif7_year <- ' 
           # direct effect
             holland_Difer7 ~ O + C + E + A + N

      '
fit_dif7_year <- sem(model_dif7_year, data = dt_hol_final, group = "serie")

lavaan::summary(fit_dif7_year, fit.measures=T, standardized=T, ci=TRUE)
```

```{r echo = FALSE}
lavaanPlot(model = fit_dif7_year, 
           node_options = list(shape = "box", fontname = "Helvetica"), 
           edge_options = list(color = "grey"), 
           coefs = TRUE, 
           stand=TRUE)
```

# Is Elev relationship with SEMS moderated by SCHOOL YEAR?
```{r echo = FALSE}
model_elev_year <- ' 
           # direct effect
             holland_Elev ~ O + C + E + A + N
      '

fit_elev_year <- sem(model_elev_year, data = dt_hol_final, group = "serie_ano")

lavaan::summary(fit_elev_year, fit.measures=T, standardized=T, ci=TRUE)
```

```{r echo = FALSE}
lavaanPlot(model = fit_elev_year, 
           node_options = list(shape = "box", fontname = "Helvetica"), 
           edge_options = list(color = "grey"), 
           coefs = TRUE, 
           stand=TRUE)
```

## Extra: Scatterplots of Differentiation and Elevation grouped by gender OR school year

### What is the relationship between dif7 and Senna domains VS gender?

```{r echo=FALSE, message=FALSE, warning=FALSE, fig.show="hold", out.width="50%"}
ggplot(dt_hol_final, aes(x=holland_Difer7, y=O, color = SEXO)) + 
    geom_point(size=0.6) +
    theme_ipsum()

ggplot(dt_hol_final, aes(x=holland_Difer7, y=C, color = SEXO)) + 
    geom_point(size=0.6) +
    theme_ipsum()
```

```{r echo=FALSE, message=FALSE, warning=FALSE, fig.show="hold", out.width="50%"}
ggplot(dt_hol_final, aes(x=holland_Difer7, y=E, color = SEXO)) + 
    geom_point(size=0.6) +
    theme_ipsum()

ggplot(dt_hol_final, aes(x=holland_Difer7, y=A, color = SEXO)) + 
    geom_point(size=0.6) +
    theme_ipsum()
```

```{r echo=FALSE, message=FALSE, warning=FALSE, fig.show="hold", out.width="50%"}
ggplot(dt_hol_final, aes(x=holland_Difer7, y=N, color = SEXO)) + 
    geom_point(size=0.6) +
    theme_ipsum()
```

### What is the relationship between dif7 and Senna domains VS school grade?

```{r echo=FALSE, message=FALSE, warning=FALSE, fig.show="hold", out.width="50%"}
ggplot(dt_hol_final, aes(x=holland_Difer7, y=O, color = serie_ano)) + 
    geom_point(size=0.6) +
    theme_ipsum()

ggplot(dt_hol_final, aes(x=holland_Difer7, y=C, color = serie_ano)) + 
    geom_point(size=0.6) +
    theme_ipsum()
```

```{r echo=FALSE, message=FALSE, warning=FALSE, fig.show="hold", out.width="50%"}
ggplot(dt_hol_final, aes(x=holland_Difer7, y=E, color = serie_ano)) + 
    geom_point(size=0.6) +
    theme_ipsum()

ggplot(dt_hol_final, aes(x=holland_Difer7, y=A, color = serie_ano)) + 
    geom_point(size=0.6) +
    theme_ipsum()
```

```{r echo=FALSE, message=FALSE, warning=FALSE, fig.show="hold", out.width="50%"}
ggplot(dt_hol_final, aes(x=holland_Difer7, y=N, color = serie_ano)) + 
    geom_point(size=0.6) +
    theme_ipsum()
```

### What is the relationship between Elev and Senna domains VS gender?

```{r echo=FALSE, message=FALSE, warning=FALSE, fig.show="hold", out.width="50%"}
ggplot(dt_hol_final, aes(x=holland_Elev, y=O, color = SEXO)) + 
    geom_point(size=1) +
    theme_ipsum()

ggplot(dt_hol_final, aes(x=holland_Elev, y=C, color = SEXO)) + 
    geom_point(size=1) +
    theme_ipsum()
```

```{r echo=FALSE, message=FALSE, warning=FALSE, fig.show="hold", out.width="50%"}
ggplot(dt_hol_final, aes(x=holland_Elev, y=E, color = SEXO)) + 
    geom_point(size=1) +
    theme_ipsum()

ggplot(dt_hol_final, aes(x=holland_Elev, y=A, color = SEXO)) + 
    geom_point(size=1) +
    theme_ipsum()
```

```{r echo=FALSE, message=FALSE, warning=FALSE, fig.show="hold", out.width="50%"}
ggplot(dt_hol_final, aes(x=holland_Elev, y=N, color = SEXO)) + 
    geom_point(size=1) +
    theme_ipsum()
```

### What is the relationship between Elev and Senna domains VS school grade?

```{r echo=FALSE, message=FALSE, warning=FALSE, fig.show="hold", out.width="50%"}
ggplot(dt_hol_final, aes(x=holland_Elev, y=O, color = serie_ano)) + 
    geom_point(size=1) +
    theme_ipsum()

ggplot(dt_hol_final, aes(x=holland_Elev, y=C, color = serie_ano)) + 
    geom_point(size=1) +
    theme_ipsum()
```

```{r echo=FALSE, message=FALSE, warning=FALSE, fig.show="hold", out.width="50%"}
ggplot(dt_hol_final, aes(x=holland_Elev, y=E, color = serie_ano)) + 
    geom_point(size=1) +
    theme_ipsum()

ggplot(dt_hol_final, aes(x=holland_Elev, y=A, color = serie_ano)) + 
    geom_point(size=1) +
    theme_ipsum()
```

```{r echo=FALSE, message=FALSE, warning=FALSE, fig.show="hold", out.width="50%"}
ggplot(dt_hol_final, aes(x=holland_Elev, y=N, color = serie_ano)) + 
    geom_point(size=1) +
    theme_ipsum()
```

## Extra: Networks
```{r echo=FALSE}
senna_sec_names <- c("A","C", "E", "N", "O",
                        "holland_Difer7", "holland_Elev"
                        )

senna_riasec_cor <- cor(dt_hol_final[,senna_sec_names], 
                             use="pairwise.complete.obs"
                        )

graph_ori <- qgraph(
  senna_riasec_cor,
  graph = "glasso", 
  layout = "circular",
  sampleSize = 101541,
  edge.labels = TRUE,
  #overlay=TRUE,
  #tuning=0.25,
  threshold = TRUE,
  #minimum = "sig",
  #maximum = 0.4, 
  alpha = 0.05,
  vsize = 8,
  #esize = 40,
  theme = "colorblind",
  cut = 0,
  vTrans = 144,
  label.cex=0.8,
  GLratio = 1.8,
  legend.cex = 0.25
  #legend = FALSE
)

```

```{r eval = FALSE}
# dt_hol_final_f <- dt_hol_final %>% 
#  filter(SEXO == "F")
# 
# senna_riasec_cor_f <- cor(dt_hol_final_f[,senna_sec_names], 
#                              use="pairwise.complete.obs"
#                         )
# 
# dt_hol_final_m <- dt_hol_final %>% 
#  filter(SEXO == "M")
# 
# senna_riasec_cor_m <- cor(dt_hol_final_m[,senna_sec_names], 
#                              use="pairwise.complete.obs"
#                         )
```


```{r echo = FALSE, eval = FALSE}
# Network - Girls and Boys (in order)
# graph_ori_f <- qgraph(
#   senna_riasec_cor_f,
#   graph = "glasso", 
#   layout = "circular",
#   sampleSize = 101541,
#   edge.labels = TRUE,
#   #overlay=TRUE,
#   #tuning=0.25,
#   threshold = TRUE,
#   #minimum = "sig",
#   #maximum = 0.4, 
#   alpha = 0.05,
#   vsize = 8,
#   #esize = 40,
#   theme = "colorblind",
#   cut = 0,
#   vTrans = 144,
#   label.cex=0.8,
#   GLratio = 1.8,
#   legend.cex = 0.25
#   #legend = FALSE
# )
# 
# graph_ori_m <- qgraph(
#   senna_riasec_cor_m,
#   graph = "glasso", 
#   layout = "circular",
#   sampleSize = 101541,
#   edge.labels = TRUE,
#   #overlay=TRUE,
#   #tuning=0.25,
#   threshold = TRUE,
#   #minimum = "sig",
#   #maximum = 0.4, 
#   alpha = 0.05,
#   vsize = 8,
#   #esize = 40,
#   theme = "colorblind",
#   cut = 0,
#   vTrans = 144,
#   label.cex=0.8,
#   GLratio = 1.8,
#   legend.cex = 0.25
#   #legend = FALSE
# )
```


```{r echo = FALSE, eval = FALSE}
#Evaluating the network (Senna + mot)
# ew <- graph_ori$Edgelist$weight
# 
# sum(ew != 0) # the number of edges: 19
# sum(ew > 0) # the number of positive edges: 17
# sum(ew < 0) # the number of negative edges: 2
# 
# t.test(abs (ew [ew > 0]), abs(ew [ew < 0]), var.equal
#        = TRUE) 

#positive edges are associated with larger weights (m= 0.14) than negative edges (m=0.06)
#the difference is significant p=0.015
```

```{r echo = FALSE, eval = FALSE}
#centrality measures
# pdf("Network - Centrality plots - Original scores.pdf")
# centralityPlot(graph_ori, include = "all")
# dev.off()
# 
# centralityTable(graph_ori)
# ```
# ```{r}
# # Network accuracy
# # Build network because graph does not work
# library(bootnet)
# Network <- estimateNetwork(dt_hol_final[,senna_sec_names], default = "EBICglasso")
```

```{r echo = FALSE, eval = FALSE}
# Bootstrap for CIs
# boot1 <- bootnet(base_holl3_domain, nBoots = 1000, type="case")
# 
# boot1 <- bootnet(base_holl3_domain, 
#                  statistics = c("edge", "Strength","Closeness"),
#                  nboots = 1000, type = "nonparametric")

# boot1 <- bootnet(Network, 
#                  statistics = c("edge", "Strength","Closeness"),
#                  nBoots = 1000)
# 
# # Edge-weight accuracy
# plot(boot1, statistics = "edge", 
#      #labels = TRUE,
#      cex.axis = 0.5,
#      order = "sample")
# 
# ## CIs are not large; thus, edges weight do not seem to overlap. 
# #The generally large bootstrapped, CIs imply that interpreting the 
# # order of most edges in the network should be done with care. 
# 
# # Difference tests
# differenceTest(boot1, 11, 16, "strength"
# )

# Black edges indicate nodes that differ in strength between each other
# The plot method can be used to plot the difference tests between all pairs of edges and centrality indices.
# For example, the following code plots the difference tests
# of node strength between all pairs of edge-weights:
# plot(boot1, "edge", plot = "difference",
#      onlyNonZero = TRUE, order = "sample")
# 
# # Centrality stability
# boot2 <- bootnet(Network, nBoots = 1000, type = "case", 
#                  statistics = c('strength',
#                  'expectedInfluence',
#                  'betweenness',
#                  'closeness'))
# 
# plot(boot1, 'all')
# plot(boot2, 'all')
```
